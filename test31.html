<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <title>Toolivo Image Converter | Free Online Image Format Converter</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Free online image converter to convert PNG to JPG, JPG to PNG, WebP, and more. Fast, secure, batch image converter that works directly in your browser.">
    <meta name="keywords" content="free online image converter, png to jpg converter online, jpg to png converter free, online image format converter, convert png to webp online, free webp converter online, image to webp converter free, batch image converter free, convert image formats online, webp to png converter online">
    <meta name="author" content="Mushfikur Riad">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Toolivo Image Converter | Free Online Image Converter">
    <meta property="og:description" content="Convert images online for free. Easily change PNG to JPG, JPG to PNG, WebP, and more with this fast and private image converter.">
    <meta property="og:image" content="https://toolivo.github.io/assets/og-image-converter.webp">
    <meta property="og:url" content="https://toolivo.github.io/tool/image-converter.html">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Toolivo">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Toolivo Image Converter | Free Online Image Converter">
    <meta name="twitter:description" content="Convert PNG, JPG, WebP and more online. Free batch image converter with fast, browser-based processing.">
    <meta name="twitter:image" content="https://toolivo.github.io/assets/og-image-converter.webp">
    <meta name="twitter:creator" content="@toolivo">

    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#2563eb">
    <meta name="msapplication-TileColor" content="#2563eb">
    <link rel="canonical" href="https://toolivo.github.io/tool/image-converter.html">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://toolivo.github.io/tool/favicon.png">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
       :root {
    --primary-blue: #2563eb;
    --blue-600: #2563eb;
    --blue-700: #1d4ed8;
    --blue-800: #1e40af;
    --light-bg: #ffffff;
    --light-text: #1f2937;
    --light-card: rgba(255,255,255,0.98);
    --dark-bg-1: #071127;
    --dark-bg-2: #071a2b;
    --dark-text: #e6eef8;
    --dark-card: #0f1724;
    --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    --border-radius: 12px;
    --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    --menu-width: 280px;
    --container-max-width: 1400px;
    
    /* ADD THESE NEW VARIABLES FOR THE IMAGE CONVERTER TOOL */
    --primary-blue-light: #3b82f6;
    --primary-blue-dark: #1d4ed8;
    --gradient-blue: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    --success: #10b981;
    --error: #ef4444;
    --warning: #f59e0b;
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --radius: 0.5rem;
    --radius-lg: 1rem;
    --background: #f8fafc;
    --surface: #ffffff;
    --text-primary: #1e293b;
    --text-secondary: #64748b;
    --border: #e2e8f0;
    
    /* Dark mode variables for the tool */
    --dark-surface: #0f1724;
    --dark-text-primary: #e6eef8;
    --dark-text-secondary: #94a3b8;
    --dark-border: #1e293b;
}

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--blue-600), var(--blue-700), var(--blue-800));
            color: var(--light-text);
            line-height: 1.6;
            padding: 5px;
            min-height: 100vh;
            transition: var(--transition);
            margin-top: -1.5rem;
            max-width: var(--container-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        body.dark-mode {
            background: linear-gradient(135deg, var(--dark-bg-1), var(--dark-bg-2));
            color: var(--dark-text);
        }

        /* === Menu Toggle === */
        .menu-toggle {
            background: transparent;
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 6px;
            transition: background 0.3s;
            z-index: 10;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        .menu-toggle:hover {
            background: rgba(255,255,255,0.08);
        }

        body.dark-mode .menu-toggle:hover {
            background: rgba(255,255,255,0.04);
        }

        .menu-toggle span {
            display: block;
            height: 3px;
            width: 24px;
            border-radius: 2px;
            background: white;
            transition: var(--transition);
            transform-origin: center;
        }

        body.dark-mode .menu-toggle span {
            background: #e6eef8;
        }

        .menu-toggle.open span:nth-child(1) {
            transform: translateY(9px) rotate(45deg);
        }
        .menu-toggle.open span:nth-child(2) {
            opacity: 0;
        }
        .menu-toggle.open span:nth-child(3) {
            transform: translateY(-9px) rotate(-45deg);
        }
        
        /* Glowing effect for cards in dark mode — hover-only transition to preserve lazy-load animations */
        body.dark-mode .visual-card,
        body.dark-mode .tool-section,
        body.dark-mode .article-section,
        body.dark-mode .feature-card,
        body.dark-mode .troubleshooting-card,
        body.dark-mode .related-tools-card,
        body.dark-mode .steps,
        body.dark-mode .about-content,
        body.dark-mode .faq-item {
            box-shadow: 0 0 14px 3px rgba(14, 165, 233, 0.15);
        }

        /* ✅ Only apply transition to box-shadow on hover/focus — avoids overriding opacity/transform transitions */
        body.dark-mode .visual-card:hover,
        body.dark-mode .tool-section:hover,
        body.dark-mode .article-section:hover,
        body.dark-mode .feature-card:hover,
        body.dark-mode .troubleshooting-card:hover,
        body.dark-mode .related-tools-card:hover,
        body.dark-mode .steps:hover,
        body.dark-mode .about-content:hover,
        body.dark-mode .faq-item:hover {
            box-shadow: 0 0 20px 6px rgba(14, 165, 233, 0.25);
            transition: box-shadow 0.3s ease;
        }
        
        /* === Breadcrumb === */
        .breadcrumb {
            padding: 0.3rem 0.3rem;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 0 0 8px 8px;
            margin-bottom: 2px;
            margin-top: 25px
        }
        body.dark-mode .breadcrumb {
            background: rgba(255, 255, 255, 0.04);
        }
        .breadcrumb ul {
            display: flex;
            flex-wrap: wrap;
            gap: 0.1rem;
            margin: 0;
            padding: 0;
            list-style: none;
            font-size: 0.5rem;
            align-items: center;
        }
        .breadcrumb li {
            display: flex;
            align-items: center;
        }
        .breadcrumb li:not(:last-child)::after {
            content: "/";
            margin: 0 0.1rem;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
        }
        .breadcrumb a {
            color: rgba(255, 255, 255, 0.85);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            transition: var(--transition);
        }
        .breadcrumb a:hover {
            color: white;
        }
        body.dark-mode .breadcrumb a {
            color: rgba(230, 238, 248, 0.85);
        }
        body.dark-mode .breadcrumb a:hover {
            color: #e6eef8;
        }
        .breadcrumb li[aria-current="page"] {
            color: #e6eef8;
            font-weight: 600;
        }
        body.dark-mode .breadcrumb li[aria-current="page"] {
            color: #cbd5e1;
        }
        .breadcrumb i {
            font-size: 0.9em;
        }

        /* === Menu Card === */
        .menu-card {
            position: fixed;
            top: 80px;
            left: 20px;
            width: var(--menu-width);
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 12px 32px rgba(0,0,0,0.24);
            transform: translateX(-145%);
            transition: transform 0.36s cubic-bezier(0.22, 0.61, 0.36, 1);
            z-index: 1000;
            padding: 1.5rem;
            max-height: 80vh;
            max-width: 500px;
            overflow-y: auto;
        }
        body.dark-mode .menu-card {
            background: #0f1724;
        }

        .menu-card.open {
            transform: translateX(0);
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid rgba(0,0,0,0.1);
        }

        body.dark-mode .menu-header {
            border-bottom-color: rgba(255,255,255,0.1);
        }

        .menu-header h3 {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .menu-close {
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .menu-close:hover {
            background: rgba(0,0,0,0.05);
        }

        body.dark-mode .menu-close:hover {
            background: rgba(255,255,255,0.05);
        }

        .menu-close svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
        }

        .menu-list {
            list-style: none;
            padding: 0;
        }
        
        body.dark-mode .menu-close svg {
            color: #e6eef8;
        }

        .menu-item {
            margin-bottom: 0.75rem;
        }

        .menu-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0.25rem 1rem 0.25rem 0.25rem;
            color: var(--light-text);
            text-decoration: none;
            font-weight: 500;
            font-size: 1.05rem;
            border-radius: 8px;
            transition: var(--transition);
            -webkit-tap-highlight-color: transparent;
        }

        body.dark-mode .menu-link {
            color: var(--dark-text);
        }

        .menu-link:hover {
            background: rgba(37,99,235,0.1);
            transform: translateX(4px);
        }

        body.dark-mode .menu-link:hover {
            background: rgba(14,165,233,0.12);
        }

        .menu-icon {
            width: 20px;
            opacity: 0.7;
        }

        /* Backdrop */
        .backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.45);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.24s, visibility 0.24s;
            z-index: 999;
        }

        .backdrop.visible {
            opacity: 1;
            visibility: visible;
        }

        /* Header Styles */
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.2rem;
            padding: 0.2rem 0;
            gap: 0.8rem;
        }

        .logo-container {
            flex: 1;
            display: flex;
            justify-content: center;
        }

        .logo {
            max-width: 200px;
            height: auto;
            transition: transform 0.28s;
        }

        .logo:hover {
            transform: scale(1.04);
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ffffff, #e0f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        body.dark-mode h1 {
            background: linear-gradient(135deg, #ffffff, #e6eef8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .tagline {
            font-size: 1rem;
            color: #ffffff;
            font-weight: 400;
            opacity: 0.6;
        }

        body.dark-mode .tagline {
            color: var(--dark-text);
        }

        /* === Theme Toggle === */
        .theme-toggle {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 1000;
            background: rgba(255,255,255,0.14);
            border: none;
            width: 38px;
            height: 38px;
            border-radius: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s, visibility 0.3s;
            box-shadow: 0 4px 14px rgba(0,0,0,0.12);
            -webkit-tap-highlight-color: transparent;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.9) translateY(-4px);
        }

        .theme-toggle.visible {
            opacity: 1;
            visibility: visible;
            transform: scale(1) translateY(0);
        }

        body.dark-mode .theme-toggle {
            background: rgba(255,255,255,0.06);
        }

        .theme-toggle:hover {
            transform: scale(1.05);
            background: rgba(255,255,255,0.2);
        }

        body.dark-mode .theme-toggle:hover {
            background: rgba(255,255,255,0.1);
        }

        .theme-icon {
            position: absolute;
            width: 24px;
            height: 24px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            stroke: currentColor;
        }

        .sun-icon {
            opacity: 1;
            transform: rotate(0deg);
            color: #ff8c00;
        }

        .moon-icon {
            opacity: 0;
            transform: rotate(-90deg);
            color: #e6eef8;
        }

        body.dark-mode .sun-icon {
            opacity: 0;
            transform: rotate(90deg);
        }

        body.dark-mode .moon-icon {
            opacity: 1;
            transform: rotate(0deg);
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* View Transition Support */
        @supports (view-transition-name: none) {
            ::view-transition-old(root),
            ::view-transition-new(root) {
                animation: none;
                mix-blend-mode: normal;
            }
            
            ::view-transition-old(root) {
                z-index: 1;
            }
            
            ::view-transition-new(root) {
                z-index: 9999;
            }
            
            .dark-mode::view-transition-old(root) {
                z-index: 9999;
            }
            
            .dark-mode::view-transition-new(root) {
                z-index: 1;
            }
        }

        /* === Social Sharing Section === */
        .social-sharing {
            text-align: center;
            margin: 3rem 0;
            padding: 2rem 0;
            border-top: 1px solid rgba(255,255,255,0.06);
            border-bottom: 1px solid rgba(255,255,255,0.06);
        }

        .social-sharing h3 {
            color: white;
            margin-bottom: 1.5rem;
            font-size: 1.4rem;
            font-weight: 600;
        }

        body.dark-mode .social-sharing h3 {
            color: var(--dark-text);
        }

        .social-icons {
            display: flex;
            justify-content: center;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        .social-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1.4rem;
            transition: var(--transition);
            cursor: pointer;
            text-decoration: none;
            -webkit-tap-highlight-color: transparent;
            position: relative;
            overflow: hidden;
        }

        .social-icon:hover {
            transform: translateY(-5px) scale(1.1);
            background: rgba(255, 255, 255, 0.2);
        }

        /* Platform-specific hover colors */
        .social-icon.x-twitter:hover { background: #000000; }
        .social-icon.linkedin:hover { background: #0077B5; }
        .social-icon.facebook:hover { background: #0068FF; }
        .social-icon.whatsapp:hover { background: #25D366; }
        .social-icon.telegram:hover { background: #0088cc; }
        .social-icon.instagram:hover { background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); }
        .social-icon.reddit:hover { background: #FF4500; }
        .social-icon.pinterest:hover { background: #BD081C; }
        .social-icon.messenger:hover { background: #006AFF; }
        .social-icon.email:hover { background: #EA4335; }

        /* Click animation effect */
        .social-icon.clicked {
            animation: clickPulse 0.4s ease-out;
        }

        @keyframes clickPulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(0.9);
            }
            100% {
                transform: scale(1);
            }
        }

        /* === Footer === */
        .comprehensive-footer {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 16px;
            padding: 3rem 2rem;
            margin-top: 4rem;
            color: white;
        }

        body.dark-mode .comprehensive-footer {
            background: rgba(0, 0, 0, 0.2);
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 2.5rem;
        }

        @media (min-width: 768px) {
            .footer-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .footer-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .footer-section h4 {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
            position: relative;
            padding-bottom: 0.5rem;
        }

        .footer-section h4::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 2px;
            background: rgba(255, 255, 255, 0.5);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            -webkit-tap-highlight-color: transparent;
        }

        .footer-links a:hover {
            color: white;
            transform: translateX(5px);
        }

        .footer-links a svg {
            width: 16px;
            height: 16px;
            opacity: 0.7;
        }

        .footer-bottom {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.06);
            font-size: 0.92rem;
            opacity: 0.9;
        }

        .creator-credit {
            margin-top: 1rem;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* === Removed Tool Section Styles === */
        
        /* Related Tools Section */
        .related-tools-section {
            margin-bottom: 3rem;
        }
        
        .related-tools-card {
            background: var(--light-card);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--box-shadow);
            text-align: center;
            border: 2px dashed rgba(37, 99, 235, 0.2);
            transition: var(--transition);
        }

        body.dark-mode .related-tools-card {
            background: var(--dark-card);
            border-color: rgba(14, 165, 233, 0.2);
        }

        .related-tools-card:hover {
            border-color: var(--blue-600);
            transform: translateY(-5px);
        }

        body.dark-mode .related-tools-card:hover {
            border-color: #0ea5e9;
        }

        .related-tools-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--light-text);
        }

        body.dark-mode .related-tools-title {
            color: var(--dark-text);
        }

        .related-tools-description {
            margin-bottom: 1.5rem;
            color: #6c757d;
        }

        body.dark-mode .related-tools-description {
            color: rgba(230, 238, 248, 0.7);
        }

        .related-tools-button {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, var(--blue-600), var(--blue-800));
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: var(--transition);
            margin-bottom: 0.5rem;
        }

        body.dark-mode .related-tools-button {
            background: linear-gradient(135deg, #0ea5e9, #0369a1);
        }

        .related-tools-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.3);
        }

        body.dark-mode .related-tools-button:hover {
            box-shadow: 0 6px 20px rgba(14, 165, 233, 0.3);
        }

        .connected-tools {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .connected-tool-link {
            color: var(--blue-600);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            background: rgba(37, 99, 235, 0.1);
            transition: var(--transition);
        }

        body.dark-mode .connected-tool-link {
            color: #0ea5e9;
            background: rgba(14, 165, 233, 0.1);
        }

        .connected-tool-link:hover {
            background: var(--blue-600);
            color: white;
        }

        body.dark-mode .connected-tool-link:hover {
            background: #0ea5e9;
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: white;
            text-align: center;
            position: relative;
            padding-bottom: 0.5rem;
        }

        body.dark-mode .section-title {
            color: var(--dark-text);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, var(--blue-600), var(--blue-800));
            border-radius: 2px;
            border: 1px solid #e3e4f5;
            box-sizing: border-box;
        }

        body.dark-mode .section-title::after {
            background: linear-gradient(90deg, #0ea5e9, #0369a1);
            border: none;
        }

        body.dark-mode .related-tools-title {
            color: white;
        }

        body.dark-mode .related-tools-description {
            color: rgba(255, 255, 255, 0.9);
        }

        body.dark-mode .connected-tool-link {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        body.dark-mode .connected-tool-link:hover {
            background: #0ea5e9;
            color: white;
        }

        /* Features Section */
        .features-section {
            margin-bottom: 3rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .feature-card {
            background: var(--light-card);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--box-shadow);
            text-align: center;
            transition: var(--transition);
            border-top: 4px solid transparent;
        }

        body.dark-mode .feature-card {
            background: var(--dark-card);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            border-top: 4px solid var(--blue-600);
        }

        body.dark-mode .feature-card:hover {
            border-top-color: #0ea5e9;
        }

        .feature-icon {
            font-size: 2.5rem;
            color: var(--blue-600);
            margin-bottom: 1rem;
        }

        body.dark-mode .feature-icon {
            color: #0ea5e9;
        }

        .feature-title {
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            color: var(--light-text);
        }

        body.dark-mode .feature-title {
            color: var(--dark-text);
        }

        /* How to Use Section */
        .how-to-section {
            margin-bottom: 3rem;
        }

        .steps {
            background: var(--light-card);
            border-radius: var(--border-radius);
            padding: 2.5rem;
            box-shadow: var(--box-shadow);
            position: relative;
        }

        body.dark-mode .steps {
            background: var(--dark-card);
        }

        .step {
            display: flex;
            margin-bottom: 2rem;
            position: relative;
        }

        .step:last-child {
            margin-bottom: 0;
        }

        .step::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 40px;
            bottom: -2rem;
            width: 2px;
            background: rgba(37, 99, 235, 0.1);
            z-index: 1;
        }

        body.dark-mode .step::before {
            background: rgba(14, 165, 233, 0.1);
        }

        .step:last-child::before {
            display: none;
        }

        .step-number {
            background: linear-gradient(135deg, var(--blue-600), var(--blue-800));
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1.5rem;
            flex-shrink: 0;
            z-index: 2;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
        }

        body.dark-mode .step-number {
            background: linear-gradient(135deg, #0ea5e9, #0369a1);
            box-shadow: 0 4px 10px rgba(14, 165, 233, 0.3);
        }

        .step-content h3 {
            margin-bottom: 0.5rem;
            color: var(--light-text);
        }

        body.dark-mode .step-content h3 {
            color: var(--dark-text);
        }

        /* === REDESIGNED ARTICLE SECTION === */
        .article-section {
            background: var(--light-card);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 1.8rem;
            margin-bottom: 3rem;
            overflow: hidden;
            border-left: 4px solid var(--blue-600);
        }

        body.dark-mode .article-section {
            background: var(--dark-card);
            border-left: 4px solid #0ea5e9;
        }

        .article-header {
            text-align: center;
            margin-bottom: 1.8rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(37, 99, 235, 0.1);
        }

        body.dark-mode .article-header {
            border-bottom-color: rgba(14, 165, 233, 0.1);
        }

        .article-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, var(--blue-600), var(--blue-800));
            color: white;
            padding: 0.4rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.8rem;
        }

        body.dark-mode .article-badge {
            background: linear-gradient(135deg, #0ea5e9, #0369a1);
        }

        .article-title {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            color: var(--light-text);
            line-height: 1.3;
            font-weight: 700;
        }

        body.dark-mode .article-title {
            color: var(--dark-text);
        }

        .article-subtitle {
            font-size: 1.1rem;
            color: #6b7280;
            font-weight: 400;
        }

        body.dark-mode .article-subtitle {
            color: rgba(230, 238, 248, 0.7);
        }

        /* Article Single Column Container */
        .article-single-content {
            display: block;
            width: 100%;
        }

        @media (min-width: 768px) {
            .article-single-content {
                max-width: 800px;
                margin: 0 auto;
            }
        }

        .article-intro {
            background: rgba(37, 99, 235, 0.05);
            border-radius: 10px;
            padding: 1.2rem;
            margin-bottom: 1.2rem;
            border-left: 3px solid var(--blue-600);
        }

        body.dark-mode .article-intro {
            background: rgba(14, 165, 233, 0.05);
            border-left: 3px solid #0ea5e9;
        }

        .article-intro p {
            margin: 0;
            font-size: 1.05rem;
            line-height: 1.6;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
            margin: 1.2rem 0;
        }

        @media (min-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 0.8rem;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: var(--transition);
        }

        body.dark-mode .stat-card {
            background: rgba(14, 165, 233, 0.08);
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--blue-600);
            margin-bottom: 0.2rem;
        }

        body.dark-mode .stat-value {
            color: #0ea5e9;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #6b7280;
            font-weight: 500;
        }

        body.dark-mode .stat-label {
            color: rgba(230, 238, 248, 0.7);
        }

        /* Content Sections */
        .content-section {
            margin-bottom: 1.8rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.8rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid rgba(37, 99, 235, 0.1);
        }

        body.dark-mode .section-header {
            border-bottom-color: rgba(14, 165, 233, 0.1);
        }

        .section-icon {
            color: var(--blue-600);
            font-size: 1.2rem;
        }

        body.dark-mode .section-icon {
            color: #0ea5e9;
        }

        .section-title-sm {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--light-text);
            margin: 0;
        }

        body.dark-mode .section-title-sm {
            color: var(--dark-text);
        }

        .section-content {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--light-text);
        }

        body.dark-mode .section-content {
            color: var(--dark-text);
        }

        .section-content p {
            margin-bottom: 0.8rem;
            font-size: 1.02rem;
        }

        .section-content ul,
        .section-content ol {
            margin: 1rem 0 1rem 1.5rem;
        }

        .section-content li {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        /* Subheadings in content */
        .content-subheading {
            font-size: 1.15rem;
            font-weight: 600;
            color: var(--blue-600);
            margin: 1.5rem 0 0.8rem 0;
            padding-bottom: 0.3rem;
            border-bottom: 1px solid rgba(37, 99, 235, 0.1);
        }

        body.dark-mode .content-subheading {
            color: #0ea5e9;
            border-bottom-color: rgba(14, 165, 233, 0.1);
        }

        /* Tips Box */
        .tips-box {
            background: rgba(37, 99, 235, 0.08);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 3px solid var(--blue-600);
        }

        body.dark-mode .tips-box {
            background: rgba(14, 165, 233, 0.08);
            border-left: 3px solid #0ea5e9;
        }

        .tips-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            color: var(--blue-600);
            font-weight: 600;
            font-size: 1.05rem;
        }

        body.dark-mode .tips-header {
            color: #0ea5e9;
        }

        .tips-list {
            list-style: none;
            padding-left: 0;
        }

        .tips-list li {
            margin-bottom: 0.5rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .tips-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--blue-600);
            font-weight: bold;
        }

        body.dark-mode .tips-list li:before {
            color: #0ea5e9;
        }

        /* Article Image - Compact */
.article-image-compact {
    width: 100%;
    border-radius: 12px;
    overflow: hidden;
    margin: 1.5rem 0;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

body.dark-mode .article-image-compact {
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.article-image-compact img {
    width: 100%;
    height: 180px; /* Default height for mobile */
    object-fit: cover;
    transition: transform 0.3s ease;
}

.article-image-compact img:hover {
    transform: scale(1.05);
}

/* Desktop styles - 300px height */
@media (min-width: 768px) {
    .article-image-compact img {
        height: 300px;
    }
}

/* Optional: Adjust for very large screens */
@media (min-width: 1200px) {
    .article-image-compact img {
        height: 350px; /* Slightly taller for large desktop */
    }
}

        /* Platform Cards */
        .platform-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.8rem;
            margin: 1rem 0;
        }

        .platform-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 6px;
            padding: 0.6rem;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            transition: var(--transition);
        }

        body.dark-mode .platform-card {
            background: rgba(14, 165, 233, 0.08);
        }

        .platform-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(37, 99, 235, 0.15);
        }

        .platform-name {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 0.2rem;
            color: var(--light-text);
        }

        body.dark-mode .platform-name {
            color: var(--dark-text);
        }

        .platform-limit {
            font-size: 0.8rem;
            color: #6b7280;
        }

        body.dark-mode .platform-limit {
            color: rgba(230, 238, 248, 0.7);
        }

        .platform-details {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 0.2rem;
        }

        body.dark-mode .platform-details {
            color: rgba(230, 238, 248, 0.6);
        }

        /* See More Button */
     .see-more-btn {
    display: block;
    margin: 2rem auto;
    padding: 0.8rem 2rem;
    background: var(--blue-600);
    color: white;
    border: 1px solid #ffffff; /* White border for light mode */
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    text-align: center;
    max-width: 200px;
}

body.dark-mode .see-more-btn {
    background: #0ea5e9;
    border: none; /* Remove border in dark mode */
}

.see-more-btn:hover {
    background: var(--blue-700);
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(37, 99, 235, 0.3);
}

body.dark-mode .see-more-btn:hover {
    background: #0284c7;
    box-shadow: 0 6px 20px rgba(14, 165, 233, 0.3);
}

.see-more-content {
    margin-top: 1rem;
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.see-more-content:not([hidden]) {
    opacity: 1;
    transform: translateY(0);
}

        /* Final Insight Box */
        .final-insight {
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(37, 99, 235, 0.05);
            border-radius: 8px;
            border-left: 3px solid var(--blue-600);
            font-size: 1.05rem;
        }

        body.dark-mode .final-insight {
            background: rgba(14, 165, 233, 0.05);
            border-left: 3px solid #0ea5e9;
        }

        .final-insight strong {
            color: var(--blue-600);
        }

        body.dark-mode .final-insight strong {
            color: #0ea5e9;
        }

        /* FAQ Section */
        .faq-section {
            margin-bottom: 3rem;
        }

        .faq-item {
            background: var(--light-card);
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: var(--transition);
            cursor: pointer;
            outline: none;
        }

        body.dark-mode .faq-item {
            background: var(--dark-card);
        }

        .faq-item:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }

        /* Theme-colored stroke on focus */
        .faq-item:focus {
            outline: 2px solid var(--blue-600);
            outline-offset: 2px;
        }

        body.dark-mode .faq-item:focus {
            outline: 2px solid #0ea5e9;
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.2);
        }

        .faq-question {
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            transition: var(--transition);
            color: var(--light-text);
            outline: none;
        }

        body.dark-mode .faq-question {
            color: var(--dark-text);
        }

        .faq-question:hover {
            background: rgba(37, 99, 235, 0.05);
        }

        body.dark-mode .faq-question:hover {
            background: rgba(14, 165, 233, 0.05);
        }

        .faq-answer {
            padding: 0 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease, padding 0.3s ease;
            color: var(--light-text);
        }

        body.dark-mode .faq-answer {
            color: var(--dark-text);
        }

        .faq-item.active .faq-answer {
            padding: 0 1.5rem 1.5rem;
            max-height: 500px;
            margin-top: 1rem;
        }

        .faq-item.active .faq-question {
            background: rgba(37, 99, 235, 0.05);
            border-bottom: 1px solid rgba(37, 99, 235, 0.1);
        }

        body.dark-mode .faq-item.active .faq-question {
            background: rgba(14, 165, 233, 0.05);
            border-bottom: 1px solid rgba(14, 165, 233, 0.1);
        }

        .faq-icon {
            transition: transform 0.4s ease;
            color: var(--blue-600);
        }

        body.dark-mode .faq-icon {
            color: #0ea5e9;
        }

        .faq-item.active .faq-icon {
            transform: rotate(45deg);
        }

        /* Troubleshooting Section */
        .troubleshooting-section {
            margin-bottom: 3rem;
        }

        .troubleshooting-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .hero-text {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 1.5rem 0;
        }

        .hero-text h1,
        .hero-text .tagline {
            text-align: center;
            margin: 0;
        }

        .troubleshooting-card {
            background: var(--light-card);
            border-radius: var(--border-radius);
            padding: 1.8rem;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        body.dark-mode .troubleshooting-card {
            background: var(--dark-card);
        }

        .troubleshooting-card:hover {
            transform: translateY(-5px);
        }

        .troubleshooting-card h3 {
            color: var(--blue-600);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        body.dark-mode .troubleshooting-card h3 {
            color: #0ea5e9;
        }

        /* About Section */
        .about-section {
            margin-bottom: 3rem;
        }

        .about-content {
            background: var(--light-card);
            border-radius: var(--border-radius);
            padding: 2.5rem;
            box-shadow: var(--box-shadow);
        }

        body.dark-mode .about-content {
            background: var(--dark-card);
        }

        /* Lazy loading animation styles */
        .lazy-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .lazy-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Animation for numbers */
        @keyframes countUp {
            from {
                transform: translateY(10px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .counting {
            animation: countUp 0.5s ease-out;
        }

        /* Responsive styles */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .article-section, .steps, .about-content {
                padding: 1.2rem;
            }
            
            .article-title {
                font-size: 1.5rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .step::before {
                display: none;
            }
            
            .step {
                flex-direction: column;
            }
            
            .step-number {
                margin-right: 0;
                margin-bottom: 1rem;
                align-self: flex-start;
            }
        }

        /* Light mode link color */
        .article-section a {
            color: #2563ea;
            text-decoration: none;
            transition: 0.2s ease;
            font-weight: 500;
        }

        .article-section a:hover {
            color: #1d4ed8;
            text-decoration: underline;
        }

        /* Dark mode link color */
        body.dark-mode .article-section a {
            color: #10a5e7;
        }

        body.dark-mode .article-section a:hover {
            color: #17b8ff;
            text-decoration: underline;
        }

        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: #2563ea;
            color: #ffffff;
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.85);
            transition: opacity 0.3s ease, transform 0.3s cubic-bezier(0.2, 0.6, 0.4, 1);
            z-index: 1000;
        }

        .back-to-top:hover {
            background: #2563ea;
            color: #ffffff;
            transform: scale(1.08);
        }

        body.dark-mode .back-to-top {
            background: #0ea5e9;
            color: #ffffff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        }

        body.dark-mode .back-to-top:hover {
            background: #0ea5e9;
            color: #ffffff;
            transform: scale(1.08);
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
        }

        .back-to-top svg {
            stroke: currentColor;
        }
        
        /* === TOOLIVO IMAGE CONVERTER STYLES === */
/* Main Container */
.container {
    max-width: 1400px;
    margin: 0 auto;
}

.header {
    text-align: center;
    margin-bottom: 1.5rem;
    padding: 1.5rem;
    background: var(--gradient-blue);
    border-radius: 16px;
    box-shadow: var(--shadow-lg);
    color: white;
    position: relative;
    overflow: hidden;
}

body.dark-mode .header {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
}

.header h1 {
    color: white;
    font-size: 2rem;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.header p {
    color: rgba(255,255,255,0.9);
    font-size: 1rem;
    max-width: 800px;
    margin: 0 auto;
}

/* Main Content Grid */
.main-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
}

@media (max-width: 1024px) {
    .main-content {
        grid-template-columns: 1fr;
    }
}

/* Card Styles */
.card {
    background-color: var(--surface);
    border-radius: 16px;
    box-shadow: var(--shadow-md);
    overflow: hidden;
    height: 100%;
    border: none;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

body.dark-mode .card {
    background-color: var(--dark-surface);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
}

.card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

body.dark-mode .card:hover {
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.35);
}

.card-header {
    padding: 1.25rem;
    background: var(--gradient-blue);
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

body.dark-mode .card-header {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.card-header h2 {
    color: white;
    font-size: 1.25rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-weight: 600;
}

.card-content {
    padding: 1.5rem;
}

/* Upload Area */
.upload-area {
    border: 2px dashed var(--blue-600);
    border-radius: 12px;
    padding: 2rem 1.5rem;
    text-align: center;
    background: rgba(37, 99, 235, 0.05);
    transition: all 0.3s ease;
    cursor: pointer;
    margin-bottom: 1rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 140px;
    height: auto;
}

body.dark-mode .upload-area {
    border-color: #0ea5e9;
    background: rgba(14, 165, 233, 0.05);
    color: var(--dark-text-primary);
}

.upload-area:hover {
    border-color: var(--blue-600);
    background: rgba(37, 99, 235, 0.1);
    transform: translateY(-2px);
}

body.dark-mode .upload-area:hover {
    border-color: #0ea5e9;
    background: rgba(14, 165, 233, 0.1);
}

.upload-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
    color: var(--blue-600);
    background: rgba(37, 99, 235, 0.1);
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-left: auto;
    margin-right: auto;
}

body.dark-mode .upload-icon {
    color: #0ea5e9;
    background: rgba(14, 165, 233, 0.1);
}

.upload-area h3 {
    margin-bottom: 0.25rem;
    color: var(--text-primary);
    font-size: 1rem;
    font-weight: 600;
}

body.dark-mode .upload-area h3 {
    color: var(--dark-text-primary);
}

.upload-area p {
    color: var(--text-secondary);
    margin-bottom: 1rem;
    font-size: 0.85rem;
}

body.dark-mode .upload-area p {
    color: var(--dark-text-secondary);
}

/* History Message Banner */
.history-message {
    display: none;
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--error);
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    box-shadow: var(--shadow-lg);
    z-index: 100;
    animation: fadeInOut 1s ease-in-out;
    text-align: center;
    max-width: 90%;
}

@keyframes fadeInOut {
    0% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
    20% { opacity: 1; transform: translateX(-50%) translateY(0); }
    80% { opacity: 1; transform: translateX(-50%) translateY(0); }
    100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
}

/* Buttons */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    border: none;
    font-size: 0.875rem;
    position: relative;
    overflow: hidden;
    color: white;
}

.btn-primary {
    background: var(--gradient-blue);
    color: white;
}

body.dark-mode .btn-primary {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
    color: white;
}

.btn-primary:hover {
    background: linear-gradient(135deg, #1e40af, #2563eb);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
}

body.dark-mode .btn-primary:hover {
    background: linear-gradient(135deg, #0369a1, #0ea5e9);
    box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
    color: white;
}

.btn-secondary {
    background-color: #f1f5f9;
    color: var(--text-primary);
}

body.dark-mode .btn-secondary {
    background-color: rgba(255, 255, 255, 0.1);
    color: var(--dark-text-primary);
}

.btn-secondary:hover {
    background-color: #e2e8f0;
    transform: translateY(-2px);
}

body.dark-mode .btn-secondary:hover {
    background-color: rgba(255, 255, 255, 0.15);
    color: var(--dark-text-primary);
}

.btn-success {
    background: linear-gradient(135deg, var(--success) 0%, #0da271 100%);
    color: white;
}

body.dark-mode .btn-success {
    background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
    color: white;
}

.btn-success:hover {
    background: linear-gradient(135deg, #0da271 0%, var(--success) 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    color: white;
}

.btn-danger {
    background: linear-gradient(135deg, var(--error) 0%, #dc2626 100%);
    color: white;
}

body.dark-mode .btn-danger {
    background: linear-gradient(135deg, var(--error) 0%, #dc2626 100%);
    color: white;
}

.btn-danger:hover {
    background: linear-gradient(135deg, #dc2626 0%, var(--error) 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    color: white;
}

.btn-small {
    padding: 0.5rem 1rem;
    font-size: 0.75rem;
}

/* File Controls */
.file-controls {
    display: flex;
    justify-content: space-between;
    margin-top: 1rem;
    padding: 0.75rem;
    background: rgba(37, 99, 235, 0.05);
    border-radius: 8px;
    border: 1px solid rgba(37, 99, 235, 0.1);
}

body.dark-mode .file-controls {
    background: rgba(14, 165, 233, 0.05);
    border: 1px solid rgba(14, 165, 233, 0.1);
}

.file-controls-group {
    display: flex;
    gap: 0.5rem;
}

/* File List */
.file-list {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--surface);
    margin-top: 1rem;
    position: relative;
}

body.dark-mode .file-list {
    border: 1px solid var(--dark-border);
    background: var(--dark-surface);
}

.file-item {
    display: flex;
    align-items: center;
    padding: 0.75rem;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

body.dark-mode .file-item {
    border-bottom: 1px solid var(--dark-border);
}

.file-item.selected {
    background: rgba(37, 99, 235, 0.08);
    border-left: 3px solid var(--blue-600);
}

body.dark-mode .file-item.selected {
    background: rgba(14, 165, 233, 0.08);
    border-left: 3px solid #0ea5e9;
}

.file-item:last-child {
    border-bottom: none;
}

.file-item:hover {
    background-color: rgba(37, 99, 235, 0.05);
}

body.dark-mode .file-item:hover {
    background-color: rgba(14, 165, 233, 0.05);
}

.file-checkbox {
    width: 18px;
    height: 18px;
    margin-right: 0.75rem;
    border: 2px solid #d1d5db;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

body.dark-mode .file-checkbox {
    border: 2px solid var(--dark-text-secondary);
}

.file-item.selected .file-checkbox {
    background: var(--blue-600);
    border-color: var(--blue-600);
}

body.dark-mode .file-item.selected .file-checkbox {
    background: #0ea5e9;
    border-color: #0ea5e9;
}

.file-checkbox i {
    color: white;
    font-size: 0.7rem;
    opacity: 0;
}

.file-item.selected .file-checkbox i {
    opacity: 1;
}

.file-icon {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--gradient-blue);
    border-radius: 6px;
    margin-right: 0.75rem;
    color: white;
    font-size: 0.9rem;
    flex-shrink: 0;
}

body.dark-mode .file-icon {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.file-info {
    flex: 1;
    overflow: hidden;
    min-width: 0;
}

.file-name {
    font-weight: 600;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: 0.85rem;
}

body.dark-mode .file-name {
    color: var(--dark-text-primary);
}

.file-size {
    font-size: 0.75rem;
    color: var(--text-secondary);
}

body.dark-mode .file-size {
    color: var(--dark-text-secondary);
}

.file-actions {
    flex-shrink: 0;
}

.file-remove-btn {
    background: none;
    border: none;
    color: #9ca3af;
    cursor: pointer;
    width: 32px;
    height: 32px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    transition: all 0.2s ease;
}

body.dark-mode .file-remove-btn {
    color: var(--dark-text-secondary);
}

.file-remove-btn:hover {
    background-color: var(--error);
    color: white;
    transform: scale(1.1);
}

/* Format Grid */
.format-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 10px;
    margin: 1.5rem 0;
}

@media (max-width: 768px) {
    .format-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
    }
}

.format-option {
    padding: 12px 8px;
    text-align: center;
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    min-height: 80px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

body.dark-mode .format-option {
    background: var(--dark-surface);
    border: 2px solid var(--dark-border);
    color: var(--dark-text-primary);
}

@media (max-width: 768px) {
    .format-option {
        padding: 10px 6px;
        min-height: 70px;
    }
}

.format-option:hover {
    border-color: var(--blue-600);
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

body.dark-mode .format-option:hover {
    border-color: #0ea5e9;
}

.format-option.active {
    background: var(--gradient-blue);
    color: white;
    border-color: var(--blue-600);
    box-shadow: 0 6px 16px rgba(37, 99, 235, 0.2);
}

body.dark-mode .format-option.active {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
    border-color: #0ea5e9;
    color: white;
    box-shadow: 0 6px 16px rgba(14, 165, 233, 0.2);
}

.format-icon {
    font-size: 20px;
    margin-bottom: 6px;
}

@media (max-width: 768px) {
    .format-icon {
        font-size: 18px;
        margin-bottom: 4px;
    }
}

.format-name {
    font-size: 13px;
    font-weight: 600;
    margin-bottom: 2px;
}

@media (max-width: 768px) {
    .format-name {
        font-size: 12px;
    }
}

.format-desc {
    font-size: 10px;
    opacity: 0.8;
}

@media (max-width: 768px) {
    .format-desc {
        font-size: 9px;
    }
}

/* Compression Tabs */
.compression-tabs {
    display: flex;
    background: var(--gradient-blue);
    border-radius: 10px;
    padding: 4px;
    margin: 1.5rem 0;
}

body.dark-mode .compression-tabs {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.compression-tab {
    flex: 1;
    padding: 12px;
    text-align: center;
    color: white;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
}

.compression-tab i {
    font-size: 16px;
}

.compression-tab:hover {
    background: rgba(255, 255, 255, 0.1);
}

.compression-tab.active {
    background: white;
    color: #1e40af;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

body.dark-mode .compression-tab.active {
    background: white;
    color: #0369a1;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

/* Quality Slider */
.slider-container {
    margin: 1.5rem 0;
}

.slider-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75rem;
}

.slider-label {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

body.dark-mode .slider-label {
    color: var(--dark-text-primary);
}

.slider-value {
    font-weight: 700;
    font-size: 1rem;
    color: var(--blue-700);
    background: rgba(37, 99, 235, 0.1);
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
}

body.dark-mode .slider-value {
    color: #0ea5e9;
    background: rgba(14, 165, 233, 0.1);
}

.slider {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: #e5e7eb;
    outline: none;
    -webkit-appearance: none;
    transition: all 0.3s ease;
}

body.dark-mode .slider {
    background: rgba(255, 255, 255, 0.1);
}

.slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--gradient-blue);
    cursor: pointer;
    border: 2px solid white;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    transition: all 0.2s ease;
}

body.dark-mode .slider::-webkit-slider-thumb {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.slider::-webkit-slider-thumb:hover {
    transform: scale(1.1);
    box-shadow: 0 3px 8px rgba(37, 99, 235, 0.3);
}

body.dark-mode .slider::-webkit-slider-thumb:hover {
    box-shadow: 0 3px 8px rgba(14, 165, 233, 0.3);
}

.slider-labels {
    display: flex;
    justify-content: space-between;
    margin-top: 0.5rem;
    font-size: 0.75rem;
    color: var(--text-secondary);
}

body.dark-mode .slider-labels {
    color: var(--dark-text-secondary);
}

/* Settings Dropdown */
.settings-toggle {
    width: 100%;
    padding: 0.75rem 1rem;
    background: var(--gradient-blue);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.9rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all 0.2s ease;
    margin: 1.5rem 0;
}

body.dark-mode .settings-toggle {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.settings-toggle:hover {
    background: linear-gradient(135deg, #1e40af, #2563eb);
}

body.dark-mode .settings-toggle:hover {
    background: linear-gradient(135deg, #0369a1, #0ea5e9);
}

.settings-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    background: rgba(37, 99, 235, 0.05);
    border-radius: 0 0 8px 8px;
    border: 1px solid rgba(37, 99, 235, 0.1);
    border-top: none;
}

body.dark-mode .settings-content {
    background: rgba(14, 165, 233, 0.05);
    border: 1px solid rgba(14, 165, 233, 0.1);
    border-top: none;
}

.settings-content.active {
    max-height: 300px;
}

.settings-grid {
    padding: 1rem;
    display: grid;
    gap: 0.75rem;
}

.setting-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem;
    background: var(--surface);
    border-radius: 6px;
    border: 1px solid var(--border);
}

body.dark-mode .setting-item {
    background: var(--dark-surface);
    border: 1px solid var(--dark-border);
}

.setting-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.setting-icon {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(37, 99, 235, 0.1);
    border-radius: 6px;
    color: var(--blue-600);
    font-size: 0.85rem;
}

body.dark-mode .setting-icon {
    background: rgba(14, 165, 233, 0.1);
    color: #0ea5e9;
}

.setting-text {
    flex: 1;
}

.setting-label {
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--text-primary);
    margin-bottom: 0.1rem;
}

body.dark-mode .setting-label {
    color: var(--dark-text-primary);
}

.setting-desc {
    font-size: 0.75rem;
    color: var(--text-secondary);
}

body.dark-mode .setting-desc {
    color: var(--dark-text-secondary);
}

/* Checkbox Styling */
input[type="checkbox"] {
    width: 18px;
    height: 18px;
    border-radius: 4px;
    border: 2px solid #d1d5db;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    appearance: none;
    -webkit-appearance: none;
}

body.dark-mode input[type="checkbox"] {
    border: 2px solid var(--dark-text-secondary);
}

input[type="checkbox"]:checked {
    background: var(--gradient-blue);
    border-color: var(--blue-600);
}

body.dark-mode input[type="checkbox"]:checked {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
    border-color: #0ea5e9;
}

input[type="checkbox"]:checked::after {
    content: '✓';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 0.75rem;
    font-weight: bold;
}

input[type="checkbox"]:hover {
    border-color: var(--blue-600);
}

body.dark-mode input[type="checkbox"]:hover {
    border-color: #0ea5e9;
}

/* Action Buttons */
.action-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 1.5rem;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.action-buttons .action-btn {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0;
    transform: translateY(10px);
}

.action-buttons.initial-state .action-btn.secondary:first-child {
    opacity: 1;
    transform: translateY(0);
}

.action-buttons.converted-state .action-btn {
    opacity: 1;
    transform: translateY(0);
}

.action-buttons.converted-state .top-row .action-btn:nth-child(1) {
    transition-delay: 0.1s;
}

.action-buttons.converted-state .top-row .action-btn:nth-child(2) {
    transition-delay: 0.2s;
}

.action-buttons.converted-state .action-btn:nth-child(2) {
    transition-delay: 0.3s;
}

.action-buttons.converted-state .action-btn:nth-child(3) {
    transition-delay: 0.4s;
}

.action-buttons.initial-state .top-row {
    display: block !important;
}

.action-buttons.initial-state .top-row .action-btn.secondary:first-child {
    grid-column: 1 / span 2;
    min-height: 70px;
    font-size: 18px;
    padding: 20px;
    border-radius: 12px;
    transition: all 0.4s ease;
    box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
    width: 100%;
}

.action-buttons.initial-state .top-row .action-btn.secondary:nth-child(2),
.action-buttons.initial-state .action-btn:not(.top-row .action-btn.secondary:first-child) {
    display: none !important;
}

.action-buttons.converted-state {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.action-buttons.converted-state .top-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.action-buttons.converted-state .action-btn {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.top-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    width: 100%;
}

.action-btn {
    background: var(--gradient-blue);
    color: white;
    border: none;
    padding: 14px;
    font-size: 14px;
    font-weight: 600;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.2s ease;
    width: 100%;
    min-height: 50px;
}

body.dark-mode .action-btn {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
    color: white;
}

.action-btn:hover:not(:disabled) {
    background: linear-gradient(135deg, #1e40af, #2563eb);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(37, 99, 235, 0.3);
    color: white;
}

body.dark-mode .action-btn:hover:not(:disabled) {
    background: linear-gradient(135deg, #0369a1, #0ea5e9);
    box-shadow: 0 8px 20px rgba(14, 165, 233, 0.3);
    color: white;
}

.action-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.action-btn.secondary {
    background: linear-gradient(135deg, var(--success) 0%, #0da271 100%);
    color: white;
}

body.dark-mode .action-btn.secondary {
    background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
    color: white;
}

.action-btn.secondary:hover:not(:disabled) {
    background: linear-gradient(135deg, #0da271 0%, var(--success) 100%);
    box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
    color: white;
}

/* Progress Container */
.progress-container {
    width: 100%;
    display: none;
    margin-top: 1rem;
}

.progress-container.active {
    display: block;
}

.progress-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.5rem;
    align-items: center;
    font-size: 0.875rem;
    color: var(--text-primary);
}

body.dark-mode .progress-header {
    color: var(--dark-text-primary);
}

.progress-bar {
    height: 10px;
    background-color: #e5e7eb;
    border-radius: 5px;
    overflow: hidden;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}

body.dark-mode .progress-bar {
    background-color: rgba(255, 255, 255, 0.1);
}

.progress-fill {
    height: 100%;
    background: linear-gradient(135deg, var(--success) 0%, #0da271 100%);
    width: 0%;
    transition: width 0.3s ease;
}

/* Results Container */
.results-container {
    display: none;
    margin-top: 1.5rem;
    padding: 1rem;
    background: rgba(16, 185, 129, 0.1);
    border-radius: 10px;
    border: 1px solid rgba(16, 185, 129, 0.2);
    color: var(--text-primary);
}

body.dark-mode .results-container {
    background: rgba(16, 185, 129, 0.1);
    border: 1px solid rgba(16, 185, 129, 0.2);
    color: var(--dark-text-primary);
}

.results-container.active {
    display: block;
    animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.results-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
    color: var(--success);
    font-weight: 600;
    font-size: 0.95rem;
}

.results-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.stat-card {
    background: var(--surface);
    padding: 0.75rem;
    border-radius: 8px;
    text-align: center;
}

body.dark-mode .stat-card {
    background: var(--dark-surface);
}

.stat-label {
    font-size: 0.7rem;
    color: var(--text-secondary);
    margin-bottom: 0.25rem;
}

body.dark-mode .stat-label {
    color: var(--dark-text-secondary);
}

.stat-value {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--blue-700);
}

body.dark-mode .stat-value {
    color: #0ea5e9;
}

.stat-value.success {
    color: var(--success);
}

/* History Dropdown */
.history-dropdown {
    margin-top: 1.5rem;
    border-top: 1px solid var(--border);
    padding-top: 1.5rem;
}

body.dark-mode .history-dropdown {
    border-top: 1px solid var(--dark-border);
}

.history-toggle {
    width: 100%;
    padding: 0.75rem 1rem;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.9rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all 0.2s ease;
}

.history-toggle:hover {
    background: linear-gradient(135deg, #d97706, #f59e0b);
    color: white;
}

.history-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    background: rgba(245, 158, 11, 0.05);
    border-radius: 0 0 8px 8px;
    border: 1px solid rgba(245, 158, 11, 0.1);
    border-top: none;
}

body.dark-mode .history-content {
    background: rgba(245, 158, 11, 0.05);
    border: 1px solid rgba(245, 158, 11, 0.1);
}

.history-content.active {
    max-height: 300px;
    overflow-y: auto;
}

.history-items-container {
    padding: 1rem;
}

.history-item {
    padding: 0.75rem;
    margin-bottom: 0.5rem;
    background: var(--surface);
    border-radius: 6px;
    border: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
}

body.dark-mode .history-item {
    background: var(--dark-surface);
    border: 1px solid var(--dark-border);
}

.history-item:hover {
    background: rgba(37, 99, 235, 0.05);
    border-color: var(--blue-600);
}

body.dark-mode .history-item:hover {
    background: rgba(14, 165, 233, 0.05);
    border-color: #0ea5e9;
}

.history-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex: 1;
    min-width: 0;
}

.history-icon {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(245, 158, 11, 0.1);
    border-radius: 6px;
    color: #f59e0b;
    font-size: 0.85rem;
    flex-shrink: 0;
}

.history-text {
    flex: 1;
    min-width: 0;
    overflow: hidden;
}

.history-filename {
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--text-primary);
    margin-bottom: 0.1rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

body.dark-mode .history-filename {
    color: var(--dark-text-primary);
}

.history-details {
    font-size: 0.75rem;
    color: var(--text-secondary);
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    align-items: center;
}

body.dark-mode .history-details {
    color: var(--dark-text-secondary);
}

.history-format {
    color: var(--blue-600);
    font-weight: 600;
    white-space: nowrap;
}

body.dark-mode .history-format {
    color: #0ea5e9;
}

.history-size {
    color: var(--success);
    font-weight: 600;
    white-space: nowrap;
}

.history-time {
    color: var(--text-secondary);
    font-size: 0.7rem;
    white-space: nowrap;
    margin-left: auto;
    padding-left: 8px;
    flex-shrink: 0;
}

body.dark-mode .history-time {
    color: var(--dark-text-secondary);
}

@media (max-width: 480px) {
    .history-time {
        font-size: 0.65rem;
        padding-left: 4px;
    }
    
    .history-details {
        flex-direction: column;
        align-items: flex-start;
        gap: 2px;
    }
}

/* Modal */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    padding: 16px;
}

.modal-container {
    background: white;
    border-radius: 16px;
    width: 100%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

body.dark-mode .modal-container {
    background: var(--dark-surface);
}

.modal-header {
    background: var(--gradient-blue);
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
    position: relative;
}

body.dark-mode .modal-header {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.modal-title {
    font-size: 18px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

.close-btn {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    flex-shrink: 0;
}

.close-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.modal-content {
    padding: 20px;
    flex: 1;
    overflow-y: auto;
    position: relative;
    min-height: 500px;
}

/* SKELETON LOADING */
.skeleton-container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: white;
    z-index: 10;
    border-radius: 0 0 16px 16px;
    display: none;
    flex-direction: column;
    padding: 20px;
}

body.dark-mode .skeleton-container {
    background: var(--dark-surface);
}

.skeleton-container.active {
    display: flex;
}

.skeleton-image {
    width: 100%;
    height: 300px;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 12px;
    margin-bottom: 20px;
}

body.dark-mode .skeleton-image {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

.skeleton-nav {
    width: 100%;
    height: 40px;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 8px;
    margin-bottom: 20px;
}

body.dark-mode .skeleton-nav {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

.skeleton-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
}

.skeleton-stat {
    height: 150px;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 8px;
}

body.dark-mode .skeleton-stat {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

.skeleton-rename {
    height: 60px;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 8px;
    margin-bottom: 20px;
}

body.dark-mode .skeleton-rename {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

.skeleton-buttons {
    display: flex;
    gap: 12px;
}

.skeleton-button {
    flex: 1;
    height: 44px;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 8px;
}

body.dark-mode .skeleton-button {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

@keyframes loading {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
}

@media (max-width: 768px) {
    .skeleton-image {
        height: 200px;
    }
    
    .skeleton-stats {
        grid-template-columns: 1fr;
    }
    
    .skeleton-stat {
        height: 100px;
    }
}

/* Comparison Container */
.comparison-container {
    position: relative;
    width: 100%;
    height: 400px;
    border-radius: 12px;
    overflow: hidden;
    margin: 1.5rem 0;
    background: #f8fafc;
    border: 1px solid var(--border);
    transition: opacity 0.3s ease;
}

body.dark-mode .comparison-container {
    background: var(--dark-surface);
    border: 1px solid var(--dark-border);
}

@media (max-width: 768px) {
    .comparison-container {
        height: 300px;
    }
}

.comparison-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: white;
    transition: opacity 0.3s ease, filter 0.3s ease;
}

body.dark-mode .comparison-image {
    background: var(--dark-surface);
}

.img-original {
    z-index: 1;
}

.img-converted {
    z-index: 2;
    clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%);
}

.slider-handle-comparison {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 4px;
    height: 100%;
    background: rgba(255, 255, 255, 0.9);
    cursor: ew-resize;
    z-index: 3;
    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.2);
}

.slider-handle-comparison::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 24px;
    height: 24px;
    background: white;
    border: 2px solid var(--primary-blue);
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
}

body.dark-mode .slider-handle-comparison::before {
    border: 2px solid #0ea5e9;
    background: var(--dark-surface);
}

.comparison-label {
    position: absolute;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    z-index: 4;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.label-original-comparison {
    top: 12px;
    left: 12px;
    background: rgba(30, 41, 59, 0.85);
    color: white;
}

.label-converted-comparison {
    top: 12px;
    right: 12px;
    background: rgba(16, 185, 129, 0.85);
    color: white;
}

/* Navigation controls */
.slider-controls {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin: 16px 0;
}

.slider-controls.hidden {
    display: none;
}

.arrow-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: none;
    background: #eef2ff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.12);
    transition: all 0.2s ease;
}

body.dark-mode .arrow-btn {
    background: rgba(255, 255, 255, 0.1);
}

.arrow-btn svg {
    width: 16px;
    height: 16px;
    stroke: #3b5bfd;
    stroke-width: 2.5;
}

body.dark-mode .arrow-btn svg {
    stroke: #0ea5e9;
}

.arrow-btn:hover {
    background: #3b5bfd;
}

body.dark-mode .arrow-btn:hover {
    background: #0ea5e9;
}

.arrow-btn:hover svg {
    stroke: #ffffff;
}

.arrow-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    background: #f1f1f1;
}

body.dark-mode .arrow-btn:disabled {
    background: rgba(255, 255, 255, 0.05);
}

.arrow-btn:disabled svg {
    stroke: #999;
}

body.dark-mode .arrow-btn:disabled svg {
    stroke: var(--dark-text-secondary);
}

.arrow-btn:disabled:hover {
    background: #f1f1f1;
}

body.dark-mode .arrow-btn:disabled:hover {
    background: rgba(255, 255, 255, 0.05);
}

.arrow-btn:disabled:hover svg {
    stroke: #999;
}

body.dark-mode .arrow-btn:disabled:hover svg {
    stroke: var(--dark-text-secondary);
}

.arrow-btn:disabled:hover {
    background: #f1f1f1;
}

body.dark-mode .arrow-btn:disabled:hover {
    background: rgba(255, 255, 255, 0.05);
}

.arrow-btn:disabled:hover svg {
    stroke: #999;
}

body.dark-mode .arrow-btn:disabled:hover svg {
    stroke: var(--dark-text-secondary);
}

.nav-counter {
    position: absolute;
    bottom: 12px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    z-index: 4;
    display: flex;
    align-items: center;
    gap: 5px;
}

/* File Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin: 1.5rem 0;
}

@media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: 1fr;
    }
}

.stat-box {
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
}

body.dark-mode .stat-box {
    border: 1px solid var(--dark-border);
}

.stat-header {
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

body.dark-mode .stat-header {
    color: var(--dark-text-primary);
}

.stat-list {
    list-style: none;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--border);
    font-size: 0.875rem;
}

body.dark-mode .stat-item {
    border-bottom: 1px solid var(--dark-border);
}

.stat-item:last-child {
    border-bottom: none;
}

.stat-label-modal {
    color: var(--text-secondary);
}

body.dark-mode .stat-label-modal {
    color: var(--dark-text-secondary);
}

.stat-value-modal {
    font-weight: 600;
    color: var(--text-primary);
}

body.dark-mode .stat-value-modal {
    color: var(--dark-text-primary);
}

.stat-value-modal.success {
    color: var(--success);
}

/* FIXED: Better filename truncation - 30 chars with extension */
.truncate-filename {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 220px;
    display: inline-block;
}

@media (max-width: 768px) {
    .truncate-filename {
        max-width: 180px;
    }
}

/* Rename Section */
.rename-section {
    margin: 1.5rem 0;
    padding: 1rem;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px solid var(--border);
}

body.dark-mode .rename-section {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--dark-border);
}

.rename-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
    color: var(--text-primary);
    font-weight: 600;
    font-size: 14px;
}

body.dark-mode .rename-header {
    color: var(--dark-text-primary);
}

.rename-input-group {
    display: flex;
    gap: 10px;
    align-items: center;
    flex-wrap: wrap;
}

.rename-input {
    flex: 1;
    min-width: 150px;
    padding: 10px 12px;
    border: 2px solid var(--border);
    border-radius: 6px;
    font-size: 14px;
    transition: all 0.2s;
    background: var(--surface);
    color: var(--text-primary);
}

body.dark-mode .rename-input {
    background: var(--dark-surface);
    border: 2px solid var(--dark-border);
    color: var(--dark-text-primary);
}

.rename-input:focus {
    outline: none;
    border-color: var(--success);
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
}

.rename-extension {
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 14px;
    min-width: 40px;
    text-align: center;
}

body.dark-mode .rename-extension {
    color: var(--dark-text-secondary);
}

@media (max-width: 480px) {
    .rename-input-group {
        flex-direction: column;
        align-items: stretch;
    }
    
    .rename-input {
        min-width: 100%;
    }
    
    .rename-input-group .btn-primary {
        width: 100%;
    }
}

/* Modal Action Buttons */
.modal-actions {
    display: flex;
    gap: 12px;
    margin-top: 1.5rem;
    flex-wrap: wrap;
}

.modal-actions .action-btn {
    flex: 1;
    min-height: 44px;
    min-width: 200px;
}

@media (max-width: 480px) {
    .modal-actions {
        flex-direction: column;
    }
    
    .modal-actions .action-btn {
        min-width: 100%;
    }
}

/* Download Selection Modal */
.download-selection-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1001;
    padding: 16px;
}

.download-selection-container {
    background: white;
    border-radius: 16px;
    width: 100%;
    max-width: 500px;
    max-height: 80vh;
    overflow-y: auto;
}

body.dark-mode .download-selection-container {
    background: var(--dark-surface);
}

.download-selection-header {
    background: var(--gradient-blue);
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: 16px 16px 0 0;
}

body.dark-mode .download-selection-header {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.download-selection-title {
    font-size: 18px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

.download-selection-content {
    padding: 20px;
}

.download-selection-list {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 8px;
    margin: 1rem 0;
}

body.dark-mode .download-selection-list {
    border: 1px solid var(--dark-border);
}

.download-selection-item {
    padding: 12px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

body.dark-mode .download-selection-item {
    border-bottom: 1px solid var(--dark-border);
}

.download-selection-item:hover {
    background-color: rgba(37, 99, 235, 0.05);
}

body.dark-mode .download-selection-item:hover {
    background-color: rgba(14, 165, 233, 0.05);
}

.download-selection-item:last-child {
    border-bottom: none;
}

.download-selection-checkbox {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
}

.download-selection-info {
    flex: 1;
}

.download-selection-name {
    font-weight: 600;
    font-size: 14px;
    color: var(--text-primary);
    margin-bottom: 4px;
}

body.dark-mode .download-selection-name {
    color: var(--dark-text-primary);
}

.download-selection-details {
    display: flex;
    gap: 12px;
    font-size: 12px;
    color: var(--text-secondary);
}

body.dark-mode .download-selection-details {
    color: var(--dark-text-secondary);
}

.download-selection-actions {
    display: flex;
    gap: 12px;
    margin-top: 1.5rem;
}

.download-selection-actions .btn {
    flex: 1;
}

/* Image Skeleton Loader Styles */
.image-skeleton-loader {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 12px;
    z-index: 5;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
}

body.dark-mode .image-skeleton-loader {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

.image-skeleton-loader.active {
    display: flex;
}

.image-skeleton-loader i {
    font-size: 48px;
    color: var(--blue-600);
    margin-bottom: 16px;
    opacity: 0.7;
}

body.dark-mode .image-skeleton-loader i {
    color: #0ea5e9;
}

.image-skeleton-loader span {
    color: var(--blue-700);
    font-weight: 600;
    font-size: 14px;
}

body.dark-mode .image-skeleton-loader span {
    color: #0ea5e9;
}

.comparison-container.loading .comparison-image {
    opacity: 0.3;
    filter: blur(2px);
}

/* History Search Overlay */
.history-search-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 2000;
    padding: 16px;
}

.history-search-container {
    background: white;
    border-radius: 16px;
    width: 100%;
    max-width: 500px;
    padding: 30px;
    text-align: center;
    box-shadow: var(--shadow-lg);
}

body.dark-mode .history-search-container {
    background: var(--dark-surface);
}

.history-search-icon {
    font-size: 48px;
    color: var(--blue-600);
    margin-bottom: 20px;
}

body.dark-mode .history-search-icon {
    color: #0ea5e9;
}

.history-search-title {
    font-size: 20px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 12px;
}

body.dark-mode .history-search-title {
    color: var(--dark-text-primary);
}

.history-search-message {
    color: var(--text-secondary);
    margin-bottom: 24px;
    line-height: 1.5;
    min-height: 60px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

body.dark-mode .history-search-message {
    color: var(--dark-text-secondary);
}

.history-search-message.error {
    color: var(--error);
    font-weight: 600;
}

.history-search-progress {
    width: 100%;
    height: 6px;
    background: #e5e7eb;
    border-radius: 3px;
    margin: 20px 0;
    overflow: hidden;
}

body.dark-mode .history-search-progress {
    background: rgba(255, 255, 255, 0.1);
}

.history-search-progress-fill {
    height: 100%;
    background: var(--gradient-blue);
    width: 0%;
    transition: width 0.3s ease;
}

body.dark-mode .history-search-progress-fill {
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
}

.history-search-actions {
    display: flex;
    gap: 12px;
    margin-top: 24px;
}

.history-search-actions .btn {
    flex: 1;
}

/* Utility Classes */
.hidden {
    display: none !important;
}

.text-center {
    text-align: center;
}

.file-count {
    background: rgba(255,255,255,0.2);
    color: white;
    padding: 0.2rem 0.6rem;
    border-radius: 9999px;
    font-size: 0.8rem;
    font-weight: 600;
}

/* Blur effect for settings when no images */
.blurred-section {
    position: relative;
}

.blurred-section::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(2px);
    border-radius: 16px;
    z-index: 10;
    pointer-events: none;
    transition: all 0.3s ease;
}

body.dark-mode .blurred-section::after {
    background: rgba(7, 17, 39, 0.7);
}

.upload-prompt {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1rem;
    z-index: 11;
    display: none;
    background: white;
    padding: 20px 30px;
    border-radius: 12px;
    box-shadow: var(--shadow-lg);
    border: 2px solid var(--blue-600);
    min-width: 250px;
}

body.dark-mode .upload-prompt {
    color: var(--dark-text-primary);
    background: var(--dark-surface);
    border: 2px solid #0ea5e9;
}

.blurred-section .upload-prompt {
    display: block;
}

.upload-prompt i {
    font-size: 2.5rem;
    color: var(--blue-600);
    margin-bottom: 0.75rem;
    display: block;
}

body.dark-mode .upload-prompt i {
    color: #0ea5e9;
}

/* Empty State */
.empty-state {
    padding: 2rem 1rem;
    text-align: center;
    color: var(--text-secondary);
}

body.dark-mode .empty-state {
    color: var(--dark-text-secondary);
}

.empty-state i {
    font-size: 2.5rem;
    margin-bottom: 0.75rem;
    opacity: 0.3;
}

body.dark-mode .empty-state i {
    opacity: 0.2;
}

.empty-state p {
    font-size: 0.85rem;
}

/* Focus styles for accessibility */
.btn:focus,
.format-option:focus,
.action-btn:focus,
.arrow-btn:focus {
    outline: 3px solid var(--blue-600);
    outline-offset: 2px;
}

body.dark-mode .btn:focus,
body.dark-mode .format-option:focus,
body.dark-mode .action-btn:focus,
body.dark-mode .arrow-btn:focus {
    outline: 3px solid #0ea5e9;
}

/* File item skeleton */
.file-item-skeleton {
    display: flex;
    align-items: center;
    padding: 0.75rem;
    border-bottom: 1px solid var(--border);
}

body.dark-mode .file-item-skeleton {
    border-bottom: 1px solid var(--dark-border);
}

.skeleton-checkbox {
    width: 18px;
    height: 18px;
    margin-right: 0.75rem;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 4px;
    flex-shrink: 0;
}

body.dark-mode .skeleton-checkbox {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

.skeleton-icon {
    width: 32px;
    height: 32px;
    margin-right: 0.75rem;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 6px;
    flex-shrink: 0;
}

body.dark-mode .skeleton-icon {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

.skeleton-info {
    flex: 1;
}

.skeleton-name {
    height: 16px;
    width: 70%;
    margin-bottom: 6px;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 4px;
}

body.dark-mode .skeleton-name {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

.skeleton-size {
    height: 12px;
    width: 40%;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 4px;
}

body.dark-mode .skeleton-size {
    background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
}

/* Scrollbar */
.file-list::-webkit-scrollbar,
.modal-content::-webkit-scrollbar,
.history-content::-webkit-scrollbar,
.download-selection-list::-webkit-scrollbar {
    width: 6px;
}

.file-list::-webkit-scrollbar-track,
.modal-content::-webkit-scrollbar-track,
.history-content::-webkit-scrollbar-track,
.download-selection-list::-webkit-scrollbar-track {
    background: var(--background);
    border-radius: 3px;
}

body.dark-mode .file-list::-webkit-scrollbar-track,
body.dark-mode .modal-content::-webkit-scrollbar-track,
body.dark-mode .history-content::-webkit-scrollbar-track,
body.dark-mode .download-selection-list::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
}

.file-list::-webkit-scrollbar-thumb,
.modal-content::-webkit-scrollbar-thumb,
.history-content::-webkit-scrollbar-thumb,
.download-selection-list::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 3px;
}

body.dark-mode .file-list::-webkit-scrollbar-thumb,
body.dark-mode .modal-content::-webkit-scrollbar-thumb,
body.dark-mode .history-content::-webkit-scrollbar-thumb,
body.dark-mode .download-selection-list::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
}

/* Fix progress header text colors in dark mode */
body.dark-mode .progress-header span {
    color: #0ea5e9;
}

body.dark-mode #progressText {
    color: #0ea5e9;
}

/* Fix filename text color in file selection modal */
body.dark-mode .history-search-message strong {
    color: #0ea5e9;
}

/* Ensure consistent styling for all progress-related text */
body.dark-mode .progress-header {
    color: #0ea5e9;
}

/* If you want to make sure all blue text in dark mode uses your preferred color */
body.dark-mode .progress-header span,
body.dark-mode #progressText,
body.dark-mode .history-search-message strong {
    color: #0ea5e9 !important;
}
    </style>
</head>
<body>
    <!-- Breadcrumb -->
<nav aria-label="Breadcrumb" class="breadcrumb">
    <ul>
        <li><a href="https://toolivo.github.io/tool/"><i class="fas fa-home"></i> Home</a></li>
        <li><a href="https://toolivo.github.io/tool/">Tools</a></li>
        <li aria-current="page">Image Converter</li>
    </ul>
</nav>
    <!-- Compact Menu Card -->
    <div class="menu-card" id="menuCard">
        <div class="menu-header">
            <h3>Menu</h3>
            <button class="menu-close" id="menuClose" aria-label="Close menu">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
      <ul class="menu-list">

    <!-- Home -->
    <li class="menu-item">
        <a href="index.html" class="menu-link">
            <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
            Home
        </a>
    </li>

    <!-- Tools -->
    <li class="menu-item">
        <a href="https://toolivo.github.io/tool/" class="menu-link">
        <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
  <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
</svg>
            Tools
        </a>
    </li>

    <!-- Blog -->
    <li class="menu-item">
        <a href="blog.html" class="menu-link">
            <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                <path d="M4 19h16V5H4v14z"/>
                <line x1="8" y1="9" x2="16" y2="9"/>
                <line x1="8" y1="13" x2="16" y2="13"/>
            </svg>
            Blog
        </a>
    </li>

    <!-- Community -->
    <li class="menu-item">
        <a href="community.html" class="menu-link">
            <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
            Community
        </a>
    </li>

    <!-- Request a Tool -->
    <li class="menu-item">
        <a href="request-a-tool.html" class="menu-link">
            <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                <path d="M4 20h4l10.6-10.6a3 3 0 1 0-4.2-4.2L4 16v4z"/>
                <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"/>
            </svg>
            Request a Tool
        </a>
    </li>

    <!-- About Us -->
    <li class="menu-item">
        <a href="about-us.html" class="menu-link">
            <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="16" x2="12" y2="12"/>
                <line x1="12" y1="8" x2="12.01" y2="8"/>
            </svg>
            About Us
        </a>
    </li>

    <!-- Contact Us -->
    <li class="menu-item">
        <a href="contact-us.html" class="menu-link">
            <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                <polyline points="22,6 12,13 2,6"/>
            </svg>
            Contact Us
        </a>
    </li>

</ul>
    </div>
    <div class="backdrop" id="backdrop"></div>

    <!-- Header -->
<header>
    <button class="menu-toggle" id="menuToggle" aria-label="Open menu">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <div class="logo-container">
        <a href="https://toolivo.github.io/tool/">
            <img 
                src="https://toolivo.github.io/tool/toolivo-logo.webp"
                alt="Toolivo Logo"
                class="logo"
                loading="lazy"
            >
        </a>
    </div>
    <!-- 👇 Placeholder to keep layout balanced -->
    <div style="width: 48px;"></div>


<!-- 👇 Fixed theme toggle — outside header, but visually in top-right -->
<!-- 👇 Animated Theme Toggler -->
<button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
    <svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
        <circle cx="12" cy="12" r="5" fill="none" stroke="currentColor" stroke-width="2"/>
        <line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2"/>
        <line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2"/>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2"/>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2"/>
        <line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2"/>
        <line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2"/>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2"/>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2"/>
    </svg>
    <svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" fill="none" stroke="currentColor" stroke-width="2"/>
    </svg>
    <span class="sr-only">Toggle theme</span>
</button>
</header>

    <!-- Hero Section -->
    <div class="hero-text">
    <h1>Image Converter</h1>
<p class="tagline">Convert PNG, JPG, WebP & GIF — instantly, privately, and for free.</p>
</div>

  <!-- Tool Section -->
<section class="tool-section lazy-section" id="tool-section">
    <div class="container">
        

        <div class="main-content">
            <!-- Left Column: Upload & File Management -->
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-upload"></i> Upload Images</h2>
                    <span class="file-count">0 files</span>
                </div>
                <div class="card-content">
                    <!-- History Message Banner -->
                    <div class="history-message" id="historyMessage">
                        <i class="fas fa-info-circle"></i>
                        <span id="historyMessageText"></span>
                    </div>
                    
                    <!-- Upload Area -->
                    <div class="upload-area" id="uploadArea" role="button" aria-label="Upload images" tabindex="0">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3>Drag & Drop Images</h3>
                        <p>JPG, PNG, GIF, WebP, BMP, TIFF supported</p>
                        <button class="btn btn-primary" id="browseBtn" aria-label="Browse files">
                            <i class="fas fa-folder-open"></i> Browse Files
                        </button>
                        <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
                    </div>

                    <!-- File Controls -->
                    <div class="file-controls">
                        <div class="file-controls-group">
                            <button class="btn btn-primary btn-small" id="selectAllBtn" aria-label="Select all files">
                                <i class="fas fa-check"></i> Select All
                            </button>
                            <button class="btn btn-secondary btn-small" id="deselectAllBtn" aria-label="Deselect all files">
                                <i class="fas fa-times"></i> None
                            </button>
                        </div>
                        <button class="btn btn-danger btn-small" id="clearAllBtn" aria-label="Clear all files">
                            <i class="fas fa-trash-alt"></i> Clear All
                        </button>
                    </div>

                    <!-- File List -->
                    <div class="file-list" id="fileList" role="list" aria-label="Uploaded files">
                        <div class="empty-state">
                            <i class="fas fa-images"></i>
                            <p>No images uploaded yet</p>
                        </div>
                    </div>

                    <!-- History Dropdown -->
                    <div class="history-dropdown">
                        <button class="history-toggle" id="historyToggle" aria-expanded="false" aria-controls="historyContent">
                            <span><i class="fas fa-history"></i> Conversion History</span>
                            <i class="fas fa-chevron-down" id="historyIcon"></i>
                        </button>
                        <div class="history-content" id="historyContent" role="region" aria-hidden="true">
                            <div class="history-items-container" id="historyItems" role="list" aria-label="Conversion history">
                                <div class="empty-state">
                                    <i class="fas fa-clock"></i>
                                    <p>No conversion history yet</p>
                                </div>
                            </div>
                            <div style="padding: 0 1rem 1rem; text-align: center;">
                                <button class="btn btn-danger btn-small" id="clearHistoryBtn" aria-label="Clear history">
                                    <i class="fas fa-trash"></i> Clear History
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Conversion Settings -->
            <div class="card blurred-section" id="settingsSection" role="region" aria-label="Conversion settings">
                <!-- Upload prompt shown when no images -->
                <div class="upload-prompt" id="uploadPrompt">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <div>Upload images to enable settings</div>
                </div>
                
                <div class="card-header">
                    <h2><i class="fas fa-cog"></i> Conversion Settings</h2>
                </div>
                <div class="card-content" id="settingsContent">
                    <!-- Format Selection - WebP FIRST -->
                    <div class="format-grid" id="formatGrid" role="radiogroup" aria-label="Select output format">
                        <div class="format-option active" data-format="webp" role="radio" aria-checked="true" tabindex="0">
                            <div class="format-icon">
                                <i class="fas fa-file-image"></i>
                            </div>
                            <div class="format-name">WebP</div>
                            <div class="format-desc">Modern web</div>
                        </div>
                        <div class="format-option" data-format="jpg" role="radio" aria-checked="false" tabindex="0">
                            <div class="format-icon">
                                <i class="fas fa-file-image"></i>
                            </div>
                            <div class="format-name">JPG</div>
                            <div class="format-desc">Best for photos</div>
                        </div>
                        <div class="format-option" data-format="png" role="radio" aria-checked="false" tabindex="0">
                            <div class="format-icon">
                                <i class="fas fa-file-image"></i>
                            </div>
                            <div class="format-name">PNG</div>
                            <div class="format-desc">Transparency</div>
                        </div>
                        <div class="format-option" data-format="gif" role="radio" aria-checked="false" tabindex="0">
                            <div class="format-icon">
                                <i class="fas fa-file-image"></i>
                            </div>
                            <div class="format-name">GIF</div>
                            <div class="format-desc">Animated</div>
                        </div>
                        <div class="format-option" data-format="bmp" role="radio" aria-checked="false" tabindex="0">
                            <div class="format-icon">
                                <i class="fas fa-file-image"></i>
                            </div>
                            <div class="format-name">BMP</div>
                            <div class="format-desc">Uncompressed</div>
                        </div>
                        <div class="format-option" data-format="tiff" role="radio" aria-checked="false" tabindex="0">
                            <div class="format-icon">
                                <i class="fas fa-file-image"></i>
                            </div>
                            <div class="format-name">TIFF</div>
                            <div class="format-desc">High quality</div>
                        </div>
                    </div>

                    <!-- Compression Method Tabs -->
                    <div class="compression-tabs" role="tablist" aria-label="Compression method">
                        <div class="compression-tab active" data-compression="none" role="tab" aria-selected="true" tabindex="0">
                            <i class="fas fa-ban"></i>
                            <span>No Compression</span>
                        </div>
                        <div class="compression-tab" data-compression="smart" role="tab" aria-selected="false" tabindex="0">
                            <i class="fas fa-brain"></i>
                            <span>Smart Compression</span>
                        </div>
                        <div class="compression-tab" data-compression="select" role="tab" aria-selected="false" tabindex="0">
                            <i class="fas fa-sliders-h"></i>
                            <span>Select Quality</span>
                        </div>
                    </div>

                    <!-- Quality Slider (Hidden by default) -->
                    <div class="slider-container" id="qualitySliderContainer" style="display: none;">
                        <div class="slider-header">
                            <span class="slider-label">
                                <i class="fas fa-compress-alt"></i> Quality Control
                            </span>
                            <span class="slider-value" id="qualityValue">85%</span>
                        </div>
                        <input type="range" class="slider" id="qualitySlider" min="1" max="100" value="85" step="1" aria-label="Quality level">
                        <div class="slider-labels">
                            <span>Lowest (1%)</span>
                            <span>Highest (100%)</span>
                        </div>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="more-settings">
                        <button class="settings-toggle" id="settingsToggle" aria-expanded="false" aria-controls="advancedSettings">
                            <span><i class="fas fa-cog"></i> Advanced Settings</span>
                            <i class="fas fa-chevron-down" id="settingsIcon"></i>
                        </button>
                        <div class="settings-content" id="advancedSettings" role="region" aria-hidden="true">
                            <div class="settings-grid">
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">
                                            <i class="fas fa-camera"></i>
                                        </div>
                                        <div class="setting-text">
                                            <div class="setting-label">Preserve EXIF Metadata</div>
                                            <div class="setting-desc">Keep camera info, GPS data</div>
                                        </div>
                                    </div>
                                    <input type="checkbox" id="preserveExif" checked aria-label="Preserve EXIF metadata">
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">
                                            <i class="fas fa-user-secret"></i>
                                        </div>
                                        <div class="setting-text">
                                            <div class="setting-label">Privacy Mode</div>
                                            <div class="setting-desc">Remove all metadata</div>
                                        </div>
                                    </div>
                                    <input type="checkbox" id="privacyMode" aria-label="Enable privacy mode">
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">
                                            <i class="fas fa-palette"></i>
                                        </div>
                                        <div class="setting-text">
                                            <div class="setting-label">Preserve Colors</div>
                                            <div class="setting-desc">Maintain color accuracy</div>
                                        </div>
                                    </div>
                                    <input type="checkbox" id="preserveColor" checked aria-label="Preserve colors">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-buttons initial-state" id="actionButtons">
                        <!-- Row 1: Always show Convert + Preview -->
                        <div class="top-row">
                            <button class="action-btn secondary" id="convertBtn" disabled aria-label="Convert selected images">
                                <i class="fas fa-exchange-alt"></i> Convert
                            </button>
                            
                            <button class="action-btn secondary" id="previewBtn" disabled aria-label="Preview conversion">
                                <i class="fas fa-eye"></i> Preview
                            </button>
                        </div>
                        
                        <!-- Row 2: Dynamic button - shows Download Selected for 2+ files, Download Image for 1 file -->
                        <button class="action-btn" id="downloadSelectedBtn" disabled style="display: none;" aria-label="Download selected converted images">
                            <i class="fas fa-download"></i> Download Selected
                        </button>
                        
                        <!-- Row 3: Only show for single file -->
                        <button class="action-btn" id="downloadSingleBtn" disabled style="display: none;" aria-label="Download converted image">
                            <i class="fas fa-download"></i> Download Image
                        </button>
                        
                        <!-- Row 4: Only show for multiple files (2+) -->
                        <button class="action-btn" id="downloadAllBtn" disabled style="display: none;" aria-label="Download all converted images as ZIP">
                            <i class="fas fa-file-archive"></i> Download All as ZIP
                        </button>
                    </div>
                    
                    <!-- Progress Container -->
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-header">
                            <span style="color: var(--blue-700); font-weight: 600;">Processing...</span>
                            <span id="progressText" style="color: var(--blue-600); font-weight: 600;">0% (0/0)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>

                    <!-- Results Container -->
                    <div class="results-container" id="resultsContainer">
                        <div class="results-header">
                            <i class="fas fa-check-circle"></i>
                            <span>Conversion Complete!</span>
                        </div>
                        <div class="results-stats">
                            <div class="stat-card">
                                <div class="stat-label">Converted</div>
                                <div class="stat-value" id="convertedCount">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Size Saved</div>
                                <div class="stat-value success" id="totalSavings">0%</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Format</div>
                                <div class="stat-value" id="targetFormat">WebP</div>
                            </div>
                        </div>
                        <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.4;">
                            Images converted successfully. Ready for download.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Modal for Preview -->
<div class="modal-overlay" id="modalOverlay">
    <div class="modal-container">
        <div class="modal-header">
            <div class="modal-title">
                <i class="fas fa-eye"></i>
                Image Preview & Comparison
            </div>
            <button class="close-btn" id="closeModal" aria-label="Close preview">&times;</button>
        </div>

        <div class="modal-content" id="modalContent">
            <!-- Skeleton Loading - Always shown first -->
            <div class="skeleton-container" id="skeletonLoading">
                <div class="skeleton-nav"></div>
                <div class="skeleton-image"></div>
                <div class="skeleton-stats">
                    <div class="skeleton-stat"></div>
                    <div class="skeleton-stat"></div>
                </div>
                <div class="skeleton-rename"></div>
                <div class="skeleton-buttons">
                    <div class="skeleton-button"></div>
                    <div class="skeleton-button"></div>
                </div>
            </div>
            <!-- Dynamic content will be inserted here -->
        </div>
    </div>
</div>

<!-- Modal for Download Selection -->
<div class="download-selection-modal" id="downloadSelectionModal">
    <div class="download-selection-container">
        <div class="download-selection-header">
            <div class="download-selection-title">
                <i class="fas fa-download"></i>
                Select Images to Download
            </div>
            <button class="close-btn" id="closeDownloadModal" aria-label="Close download selection">&times;</button>
        </div>
        <div class="download-selection-content">
            <p style="margin-bottom: 1rem; color: var(--text-secondary); font-size: 14px;">
                Select which converted images you want to download:
            </p>
            <div class="download-selection-list" id="downloadSelectionList">
                <!-- Dynamic content will be inserted here -->
            </div>
            <div class="download-selection-actions">
                <button class="btn btn-secondary" id="selectAllDownloadBtn">
                    <i class="fas fa-check"></i> Select All
                </button>
                <button class="btn btn-primary" id="downloadSelectedBtnModal">
                    <i class="fas fa-download"></i> Download Selected
                </button>
            </div>
        </div>
    </div>
</div>

<!-- History Search Overlay -->
<div class="history-search-overlay" id="historySearchOverlay">
    <div class="history-search-container">
        <div class="history-search-icon">
            <i class="fas fa-folder-open"></i>
        </div>
        <div class="history-search-title">
            Select File
        </div>
        <div class="history-search-message" id="historySearchMessage">
            <!-- Dynamic content will be inserted here -->
        </div>
        <div class="history-search-actions">
            <button class="btn btn-secondary" id="cancelSearchBtn">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" id="browseForFileBtn">
                <i class="fas fa-folder-open"></i> Browse Files
            </button>
        </div>
    </div>
</div>

   <!-- Related Tools Section -->
<section class="related-tools-section lazy-section">
    <div class="related-tools-card">
        <h3 class="related-tools-title">Need More Image Tools?</h3>
        <p class="related-tools-description">
            After converting images, you may want to reduce file size or edit image metadata. Try our Image Compressor or Metadata Editor to fine-tune your images before sharing or publishing.
        </p>

        <a href="image-compressor.html" class="related-tools-button">
            <i class="fas fa-compress-alt"></i> Try Image Compressor
        </a>

        <p style="font-weight: bold; margin: 0;">or</p>

        <div class="connected-tools">
            <a href="metadata-editor.html" class="connected-tool-link">Metadata Editor</a>
        </div>
    </div>
</section>

   <!-- Features Section -->
<section class="features-section lazy-section">
    <h2 class="section-title">Key Features</h2>
    <div class="features-grid">
        
        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-bolt"></i></div>
            <h3 class="feature-title">Instant Image Conversion</h3>
            <p>Convert images instantly using our free online image converter. Change PNG to JPG, JPG to PNG, or WebP formats in real time with fast, browser-based processing.</p>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-images"></i></div>
            <h3 class="feature-title">Batch Image Converter</h3>
            <p>Convert multiple images at once with our batch image converter free tool. Download all converted files together in a single ZIP to save time.</p>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
            <h3 class="feature-title">Private & Secure Processing</h3>
            <p>All image format conversion happens locally in your browser. This free online image format converter never uploads or stores your files.</p>
        </div>

    </div>
</section>

    <!-- How to Use Section -->
<section class="how-to-section lazy-section">
    <h2 class="section-title">How to Use</h2>
    <div class="steps">
        <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
                <h3>Upload Your Images</h3>
                <p>Select or drag and drop JPG, PNG, GIF, or WebP files into our free online image converter. You can convert a single image or use the batch image converter for multiple files.</p>
            </div>
        </div>

        <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
                <h3>Choose Output Format</h3>
                <p>Pick the format you need, like PNG to JPG, JPG to PNG, or convert image to WebP free. The tool supports popular image format conversions online.</p>
            </div>
        </div>

        <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
                <h3>Preview Converted Images</h3>
                <p>Preview your converted images instantly to check clarity and transparency before downloading the final result.</p>
            </div>
        </div>

        <div class="step">
            <div class="step-number">4</div>
            <div class="step-content">
                <h3>Download Your Files</h3>
                <p>Download images one by one or as a ZIP file. Ideal for web use, faster loading, and everyday image format conversion.</p>
            </div>
        </div>
    </div>
</section>

 <!-- ARTICLE SECTION -->
<section class="article-section lazy-section">
    <div class="article-header">
        <div class="article-badge">
            <i class="fas fa-image"></i> Format Freedom
        </div>
        <h2 class="article-title">Toolivo Image Converter – Free Online Image Format Converter</h2>
        <p class="article-subtitle">Switch between PNG, JPG, WebP, and GIF — instantly, accurately, and 100% free</p>
    </div>
    <div class="article-single-content">
        <!-- VISIBLE CONTENT -->
        <div class="visible-content">
            <div class="article-intro">
                <p>You shouldn't have to pay, wait, or sacrifice privacy just because a file format won't cooperate. Toolivo Image Converter was built to solve a simple but universal problem: needing to switch between image formats like PNG, JPG, WebP, and GIF — quickly, reliably, and without fuss.</p>
                <p>There's no installation, no account creation, and no hidden tiers. Everything runs in your browser, on your device. Whether you're converting a single screenshot or preparing a batch of assets for a website, Toolivo gives you full control — with zero trade-offs.</p>
            </div>
            <div class="article-image-compact">
                <img 
                    src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhXYt1UqVa0NZFwLgDWrdQsz6zQSk5i3RBVoEZiJJFA7QAuM70GMAkIrAN-QxGg39H8g2_l-WTsWuceJguhQjAXwc7DPx_dzFrBZx24W3JUR8o3onUxtlHHBsvySwhGHp5MHhhb1c4Jkj-X9cGp9nFWGOo-XQLBqd6GFj3TZvX51euIvg/s1600/1766922423011.webp" 
                    alt="Image format conversion workflow: JPG to PNG to WebP for web optimization" 
                    loading="lazy"
                >
            </div>
            <p class="stats-intro">No gimmicks. No limitations. Just a straightforward, user-first approach to image format conversion — backed by these core promises:</p>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">No</div>
                    <div class="stat-label">Sign-Up Required</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">∞</div>
                    <div class="stat-label">Unlimited Conversions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">Free</div>
                    <div class="stat-label">Forever</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">100%</div>
                    <div class="stat-label">Private & Local</div>
                </div>
            </div>
            <div class="content-section">
                <div class="section-header">
                    <i class="fas fa-exchange-alt section-icon"></i>
                    <h3 class="section-title-sm">Format Conversion, Done Right</h3>
                </div>
                <div class="section-content">
                    <p>Image conversion isn't just about changing a file extension — it's about preserving intent. A logo must keep its transparency. A screenshot needs crisp edges. An animation should stay fluid. Toolivo handles the technical details so you don't have to.</p>
                    <p>With one tool, you can:</p>
                    <ul class="format-list">
                        <li><strong>Convert PNG to JPG</strong> — for email clients, social previews, or legacy systems that don't support transparency. This is the go-to move for a reliable PNG to JPG converter online.</li>
                        <li><strong>Convert JPG to PNG</strong> — to restore lossless quality when editing, adding overlays, or preparing assets that require transparent backgrounds. Every designer needs a solid JPG to PNG converter free in their toolkit.</li>
                        <li><strong>Convert image to WebP free</strong> — to adopt the modern standard for the web. WebP delivers richer color and transparency in smaller files — and works across Chrome, Firefox, Safari, and Edge.</li>
                        <li><strong>Convert WebP to PNG</strong> — for compatibility with design software like Photoshop, Figma, or Canva, which may not yet import WebP natively. This makes Toolivo a dependable WebP to PNG converter online.</li>
                        <li><strong>Free GIF to PNG converter</strong> — to extract static frames, simplify animated assets, or prepare stills for editing. Also useful when GIF's limited color palette causes banding.</li>
                    </ul>
                    <p>No format is inherently better — only more appropriate for the task. Toolivo gives you the freedom to choose — and switch — whenever your workflow demands it. This makes it a true online image format converter: purpose-built, reliable, and format-agnostic.</p>
                </div>
            </div>
            <div class="content-section">
                <div class="section-header">
                    <i class="fas fa-layer-group section-icon"></i>
                    <h3 class="section-title-sm">Batch Power for Real Workflows</h3>
                </div>
                <div class="section-content">
                    <p>Whether you're prepping a presentation, updating a website, or organizing a design library — chances are, you're not converting just one image. That's why Toolivo includes full batch image converter free support.</p>
                    <p>Select dozens of files. Pick your target format — say, convert PNG to WebP online for your blog media folder — and convert them all at once. Each file retains its original dimensions, color depth, and — where possible — transparency. You don't need to reconfigure settings per image; Toolivo applies your choice uniformly.</p>
                    <p>This is especially valuable when migrating legacy content. Imagine updating a 5-year-old WordPress site: hundreds of PNG banners and JPG thumbnails can be standardized to WebP for performance, or converted to JPG for email templates — all in one session.</p>
                    <div class="tips-box">
                        <div class="tips-header">
                            <i class="fas fa-sync-alt"></i>
                            <span>When to Switch Formats</span>
                        </div>
                        <ul class="tips-list">
                            <li>→ <strong>JPG needed?</strong> Convert PNG or WebP for universal compatibility — especially in email clients like Outlook or older mobile apps.</li>
                            <li>→ <strong>Transparency required?</strong> Convert JPG to PNG or WebP (lossless mode) to support overlays, badges, or UI elements.</li>
                            <li>→ <strong>Sharing with non-tech users?</strong> WebP to JPG avoids "can't open" issues — many desktop users still lack native WebP support outside browsers.</li>
                            <li>→ <strong>Archiving originals?</strong> Keep backups in PNG; use converted versions for delivery — Toolivo helps you maintain both workflows seamlessly.</li>
                        </ul>
                    </div>
                    <p>This isn't just convenience — it's consistency. Every image in your set gets the same treatment, eliminating format drift across projects and reducing troubleshooting time.</p>
                </div>
            </div>
        </div>
        <!-- SEE MORE CONTENT -->
        <div class="see-more-content" id="see-more-content">
            <div class="content-section">
                <div class="section-header">
                    <i class="fas fa-file-image section-icon"></i>
                    <h3 class="section-title-sm">Truly Free. Truly Local.</h3>
                </div>
                <div class="section-content">
                    <p>Toolivo is built on a simple principle: your files belong to you. There are no servers, no uploads, and no hidden data collection. Everything — from format detection to pixel remapping — happens inside your browser using the HTML5 Canvas API and native encoding capabilities.</p>
                    <p>That means:</p>
                    <ul class="checklist">
                        <li>✅ Instant results — no waiting for uploads or queues</li>
                        <li>✅ Full fidelity — transparency, gamma, and color profiles are respected during conversion</li>
                        <li>✅ Works on sensitive or copyrighted material — no risk of exposure, accidental sharing, or third-party access</li>
                        <li>✅ No signups, no trials, no "pro" upsells — ever</li>
                    </ul>
                    <div class="article-image-compact">
                        <img 
                            src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPN-bNKrg1ZyE1t9kut0jt8ZdxBo_yeA-UYeJutrVx7BjLgDrPx7nkXKYHE_Ks4aCJHzgIIr068OoS1TibfQgyIJ4y-9wan8jGB5pARw1njA7ozrjdy-4bRWBccOSwF7rKr2bY8NwzOHq8A3G8xm-aTan5dX9A8vC0YBTjVw8RN6oInQ/s1600/image-compressor-imag-2.webp" 
                            alt="Batch image compression dashboard showing 45% file size reduction and progress status" 
                            loading="lazy"
                        >
                    </div>
                    <p>In a world of "free" tools that trade privacy for access, Toolivo is refreshingly straightforward: a <strong>free online PNG converter</strong>, a <strong>free online JPG converter free</strong>, a <strong>free WebP converter online</strong>, a <strong>PNG to JPG converter online</strong>, a <strong>JPG to PNG converter free</strong>, a <strong>WebP to PNG converter online</strong>, and more — all in one place. You're not giving up control for convenience. You're getting both.</p>
                </div>
            </div>
            <div class="content-section">
                <div class="section-header">
                    <i class="fas fa-cogs section-icon"></i>
                    <h3 class="section-title-sm">How It Works: Format Conversion in 4 Steps</h3>
                </div>
                <div class="section-content">
                    <ol class="step-list">
                        <li><strong>Upload.</strong> Drag & drop files — or click "Browse." Supports PNG, JPG, GIF, WebP, BMP, TIFF — no format left behind.</li>
                        <li><strong>Pick Your Target.</strong> Choose WebP, PNG, JPG, or GIF — clearly labeled, one click away. No confusing dropdowns or nested menus.</li>
                        <li><strong>Preview (Optional).</strong> See how the new format renders — check transparency edges, text sharpness, and color accuracy with the built-in side-by-side viewer.</li>
                        <li><strong>Download.</strong> Get your converted files individually, selected subset, or as a ZIP archive — all with original filenames (or custom-renamed if you prefer).</li>
                    </ol>
                    <p>That's it. No tutorials. No software installs. No format anxiety.</p>
                    <p>Need to convert JPG to PNG online for a client? Done in 20 seconds.  
                    Prepping assets for a developer who only wants WebP? Convert image formats online in bulk.  
                    Recovering from a tool that corrupted your files? Re-convert with confidence — Toolivo never alters your originals.</p>
                </div>
            </div>
            <div class="content-section">
                <div class="section-header">
                    <i class="fas fa-users section-icon"></i>
                    <h3 class="section-title-sm">Built for Real People, Real Needs</h3>
                </div>
                <div class="section-content">
                    <p>Toolivo serves specific, recurring needs across professions:</p>
                    <div class="use-case-grid">
                        <div class="use-case-card">
                            <div class="use-case-icon"><i class="fas fa-laptop-code"></i></div>
                            <h4>Developers</h4>
                            <p>My CMS requires WebP. Designer sent PNGs. Toolivo bridges the gap — in seconds, with no build-step or CLI dependency.</p>
                        </div>
                        <div class="use-case-card">
                            <div class="use-case-icon"><i class="fas fa-paint-brush"></i></div>
                            <h4>Designers</h4>
                            <p>Client asked for JPG previews of PNG mockups. No export hassle — just convert, rename, and send.</p>
                        </div>
                        <div class="use-case-card">
                            <div class="use-case-icon"><i class="fas fa-chalkboard-teacher"></i></div>
                            <h4>Educators</h4>
                            <p>LMS only accepts JPG. Convert student-submitted PNGs easily for grading — no desktop software needed on lab computers.</p>
                        </div>
                        <div class="use-case-card">
                            <div class="use-case-icon"><i class="fas fa-mobile-alt"></i></div>
                            <h4>Mobile Users</h4>
                            <p>No app install. Works on phone — convert and share in one flow.Uor Webpage is totally mobile-friendly.</p>
                        </div>
                    </div>
                    <p>Toolivo isn't trying to be an editor, optimizer, or AI enhancer. It's a precision tool for one job — and it does that job exceptionally well. When you need to convert image to WebP free, or run a free GIF to PNG converter, or batch process assets as a batch image converter free solution — it's there, ready, and reliable.</p>
                    <blockquote class="testimonial">
                        <p>I use it weekly. Not because I want to convert files — but because I have to. Toolivo makes that necessity effortless.<br><cite>— Alex T., UX Designer</cite></p>
                    </blockquote>
                    <div class="final-insight">
                        <strong>Final Thought:</strong> Format compatibility shouldn't be a bottleneck. With Toolivo Image Converter, switching between PNG, JPG, WebP, and GIF is as simple as saving a file. No learning curve. No compromises. Just reliable, free, format freedom — exactly as a free online image converter should be.
                    </div>
                    <div class="cta-box">
                        <p>Stuck in format limbo? Break free — instantly.</p>
                        <a href="#uploadArea" class="btn btn-primary">
                            <i class="fas fa-exchange-alt"></i> Convert Your Images Now — Free & Private
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- FAQ Section -->
<section class="faq-section lazy-section">
    <h2 class="section-title">Frequently Asked Questions</h2>
    <div class="faq-list">
        <!-- First 3 visible by default -->
        <div class="faq-group" id="faq-initial">
            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Are my images uploaded or stored anywhere?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>No. All image conversion happens locally in your browser. Your files never leave your device — no uploads, no servers, no tracking. Toolivo is a truly private free online image converter.</p>
                </div>
            </div>

            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Does format conversion affect image quality?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>Not unless you want it to. Converting between compatible formats — like PNG to JPG, JPG to PNG, or image to WebP free — preserves resolution and clarity. Transparency is maintained where the target format supports it (e.g., PNG and WebP).</p>
                </div>
            </div>

            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Which image formats can I convert?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>Toolivo supports PNG, JPG, WebP, and GIF — in any direction. Use it as a PNG to JPG converter online, JPG to PNG converter free, WebP to PNG converter online, or free GIF to PNG converter. You can also convert image to WebP free for modern web use.</p>
                </div>
            </div>
        </div>

        <!-- Hidden extra FAQs -->
        <div class="faq-group" id="faq-extra" hidden>
            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Is there a limit on image size or number of files?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>No fixed limits. You can convert large images and use the batch image converter free feature to process dozens of files at once. Speed depends on your device — not a remote server.</p>
                </div>
            </div>

            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Can I convert multiple images at the same time?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>Yes. Toolivo works as a powerful batch image converter free tool — select multiple files, choose your target format (e.g., convert PNG to WebP online), and convert them all in one click. Download individually or as a ZIP.</p>
                </div>
            </div>

            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Is Toolivo really free — forever?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>Yes. Toolivo Image Converter is 100% free — no trials, no sign-ups, no watermarks, no “Pro” upsells. It always will be.</p>
                </div>
            </div>

            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Can I convert WebP to PNG or JPG?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>Yes — and it’s one of our most common uses. Many design tools (e.g., Photoshop, Canva) don’t yet support WebP upload. With Toolivo, you can easily use a WebP to PNG converter online or WebP to JPG converter free in seconds.</p>
                </div>
            </div>

            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Does switching to WebP help website performance?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>Yes. WebP delivers sharper images at smaller file sizes than JPG or PNG — improving load time, Core Web Vitals, and SEO. Toolivo makes it easy to convert image formats online for modern web standards.</p>
                </div>
            </div>

            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Can I use this on mobile or tablet?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>Yes. Toolivo works smoothly on phones, tablets, and desktops — no app install needed. It’s a mobile-friendly free online image converter that respects your workflow anywhere.</p>
                </div>
            </div>

            <div class="faq-item" tabindex="0">
                <div class="faq-question">
                    <span>Do I need to create an account or enter my email?</span>
                    <span class="faq-icon"><i class="fas fa-plus"></i></span>
                </div>
                <div class="faq-answer">
                    <p>No. Start converting instantly — no registration, no email, no login. Just open, upload, convert, and download.</p>
                </div>
            </div>
        </div>

        <!-- See More Button -->
        <button class="see-more-btn" id="faq-see-more">
            See more FAQs <i class="fas fa-chevron-down"></i>
        </button>
    </div>
</section>

<!-- Troubleshooting Section -->
<section class="troubleshooting-section lazy-section">
    <h2 class="section-title">Troubleshooting</h2>
    <div class="troubleshooting-grid">
        
        <div class="troubleshooting-card">
            <h3><i class="fas fa-exclamation-triangle"></i> Converted image quality looks different</h3>
            <p>When using an online image format converter, quality can vary based on the original file and chosen format. Try converting PNG to JPG, JPG to PNG, or WebP to PNG to see which format best fits your needs.</p>
        </div>

        <div class="troubleshooting-card">
            <h3><i class="fas fa-tachometer-alt"></i> Image conversion feels slow</h3>
            <p>Converting large images or using the batch image converter free option may take longer on older devices. Since this free online image converter runs entirely in your browser, speed depends on your device performance.</p>
        </div>

        <div class="troubleshooting-card">
            <h3><i class="fas fa-download"></i> Download not starting</h3>
            <p>If downloads do not start, check your browser permissions or disable download blockers. Make sure JavaScript is enabled so the online image converter can generate and download files properly.</p>
        </div>

    </div>
</section>
<!-- About Section -->
<section class="about-section lazy-section">
    <h2 class="section-title">About Image Converter</h2>
    <div class="about-content">
        <p>Image Converter is a free online image converter designed for creators, developers, and everyday users who need quick and reliable image format conversion. Easily convert JPG to PNG, PNG to JPG, WebP to PNG, or convert image to WebP free directly in your browser.</p>

        <p>This online image format converter helps you prepare images for websites, blogs, ecommerce stores, and social media. Whether you need a free online PNG converter, a JPG converter online, or a fast WebP converter, the tool handles it with just a few clicks.</p>

        <p>All image conversion happens locally on your device. Your files are never uploaded, stored, or tracked. This makes it a secure choice for batch image converter free tasks, privacy-focused workflows, and everyday image conversion online.</p>
    </div>
</section>

    <!-- Share with Friends Section -->
    <section class="social-sharing">
        <h3>Share Toolivo Image Converter with your friends</h3>
        <div class="social-icons" id="socialIcons">
            <!-- Social icons will be dynamically loaded -->
        </div>
    </section>

    <!-- Footer -->
    <footer class="comprehensive-footer">
        <div class="footer-grid">
            <div class="footer-section">
                <h4>Legal</h4>
                <ul class="footer-links">
                    <li><a href="terms-conditions.html">Terms & Conditions</a></li>
                    <li><a href="privacy-policy.html">Privacy Policy</a></li>
                    <li><a href="disclaimer.html">Disclaimer</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h4>Company</h4>
                <ul class="footer-links">
                    <li><a href="about-us.html">About Us</a></li>
                    <li><a href="contact-us.html">Contact Us</a></li>
                    <li><a href="features.html">Features</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h4>Support</h4>
                <ul class="footer-links">
                    <li><a href="help-center.html">Help Center</a></li>
                    <li><a href="faqs.html">FAQ</a></li>
                    <li><a href="request-a-tool.html">Request a Tool</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h4>Connect</h4>
                <ul class="footer-links">
                    <li><a href="https://toolivo.github.io/blogs/">Blog</a></li>
                    <li><a href="updates.html">Updates</a></li>
                    <li><a href="community.html">Community</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>Toolivo &copy; 2026 — All rights reserved</p>
            <p class="creator-credit">Created with ❤️ by Mushfikur Riad</p>
        </div>
    </footer>
    <!-- Back-to-top button -->
<button id="backToTop" class="back-to-top" aria-label="Back to top">
  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 19V5M5 12l7-7 7 7"/>
  </svg>
</button>
<script>
    // === Menu Functionality ===
    const menuToggle = document.getElementById('menuToggle');
    const menuCard = document.getElementById('menuCard');
    const menuClose = document.getElementById('menuClose');
    const backdrop = document.getElementById('backdrop');

    function openMenu() {
        menuCard.classList.add('open');
        backdrop.classList.add('visible');
        menuToggle.classList.add('open');
        document.body.style.overflow = 'hidden';
    }

    function closeMenu() {
        menuCard.classList.remove('open');
        backdrop.classList.remove('visible');
        menuToggle.classList.remove('open');
        document.body.style.overflow = '';
    }

    menuToggle.addEventListener('click', () => {
        menuCard.classList.contains('open') ? closeMenu() : openMenu();
    });

    menuClose.addEventListener('click', closeMenu);
    backdrop.addEventListener('click', closeMenu);

    // === Animated Theme Toggle Functionality ===
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;

    // Check for saved theme or system preference
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const savedTheme = localStorage.getItem('theme');
    const isDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);

    async function toggleTheme() {
        if (!document.startViewTransition) {
            // Fallback for browsers without View Transitions API
            const newTheme = !body.classList.contains('dark-mode');
            applyTheme(newTheme);
            return;
        }

        await document.startViewTransition(() => {
            const newTheme = !body.classList.contains('dark-mode');
            body.classList.toggle('dark-mode', newTheme);
            localStorage.setItem('theme', newTheme ? 'dark' : 'light');
        }).ready;

        // Create circular animation
        const { top, left, width, height } = themeToggle.getBoundingClientRect();
        const x = left + width / 2;
        const y = top + height / 2;
        const maxRadius = Math.hypot(
            Math.max(left, window.innerWidth - left),
            Math.max(top, window.innerHeight - top)
        );

        document.documentElement.animate(
            {
                clipPath: [
                    `circle(0px at ${x}px ${y}px)`,
                    `circle(${maxRadius}px at ${x}px ${y}px)`,
                ],
            },
            {
                duration: 400,
                easing: 'ease-in-out',
                pseudoElement: '::view-transition-new(root)',
            }
        );
    }

    function applyTheme(isDarkMode) {
        body.classList.toggle('dark-mode', isDarkMode);
        localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
    }

    // Apply theme on page load
    applyTheme(isDark);

    // Toggle theme on button click
    themeToggle.addEventListener('click', toggleTheme);

    // === Social Icons Functionality ===
    const socialIconsContainer = document.getElementById('socialIcons');
    
    // Social icons data
    const socialIconsData = [
        { 
            name: 'x-twitter', 
            label: 'Share on X',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
            </svg>`
        },
        { 
            name: 'linkedin', 
            label: 'Share on LinkedIn',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
                <rect x="2" y="9" width="4" height="12"/>
                <circle cx="4" cy="4" r="2"/>
            </svg>`
        },
        { 
            name: 'facebook', 
            label: 'Share on Facebook',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
            </svg>`
        },
        { 
            name: 'whatsapp', 
            label: 'Share on WhatsApp',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893 0-3.189-1.248-6.189-3.515-8.444"/>
            </svg>`
        },
        { 
            name: 'telegram', 
            label: 'Share on Telegram',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.447 1.394c-.14.141-.259.259-.374.261l.213-3.053 5.56-5.022c.24-.213-.054-.334-.373-.121l-6.869 4.326-2.96-.924c-.64-.203-.658-.64.136-.954l11.566-4.458c.538-.196 1.006.128.832.941z"/>
            </svg>`
        },
        { 
            name: 'instagram', 
            label: 'Share on Instagram',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M7 2C4.24 2 2 4.24 2 7v10c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V7c0-2.76-2.24-5-5-5H7zm10 2c1.65 0 3 1.35 3 3v10c0 1.65-1.35 3-3 3H7c-1.65 0-3-1.35-3-3V7c0-1.65 1.35-3 3-3h10zm-5 3.5A4.5 4.5 0 1 0 16.5 12 4.5 4.5 0 0 0 12 7.5zm0 7A2.5 2.5 0 1 1 14.5 12 2.5 2.5 0 0 1 12 14.5zm4.75-8.75a1.25 1.25 0 1 1-1.25 1.25 1.25 1.25 0 0 1 1.25-1.25z"/>
            </svg>`
        },
        { 
            name: 'reddit', 
            label: 'Share on Reddit',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
            </svg>`
        },
        { 
            name: 'pinterest', 
            label: 'Share on Pinterest',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0C5.373 0 0 5.372 0 12c0 5.084 3.163 9.426 7.627 11.174-.105-.949-.2-2.405.042-3.441.218-.937 1.407-5.965 1.407-5.965s-.359-.719-.359-1.782c0-1.668.967-2.914 2.171-2.914 1.023 0 1.518.769 1.518 1.69 0 1.029-.655 2.568-.994 3.995-.283 1.194.599 2.169 1.777 2.169 2.133 0 3.772-2.249 3.772-5.495 0-2.873-2.064-4.882-5.012-4.882-3.414 0-5.418 2.561-5.418 5.207 0 1.031.397 2.138.893 2.738a.36.36 0 0 1 .083.345l-.333 1.36c-.053.22-.174.267-.402.161-1.499-.698-2.436-2.889-2.436-4.649 0-3.785 2.75-7.262 7.929-7.262 4.163 0 7.398 2.967 7.398 6.931 0 4.136-2.607 7.464-6.227 7.464-1.216 0-2.359-.631-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24 12 24c6.627 0 12-5.373 12-12 0-6.628-5.373-12-12-12z"/>
            </svg>`
        },
        {
            name: 'messenger',
            label: 'Share on Messenger',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.49 2 2 6.2 2 11.15c0 2.92 1.6 5.55 4.07 7.34V22l3.68-2.02c.99.28 2.07.43 3.25.43 5.51 0 10-4.2 10-9.26C23 6.2 17.51 2 12 2zm4.9 7.6-3.3 3.5-2.1-2.3-4.5 2.3 4.7-4.9 2.1 2.3 3.1-1.9z"/>
            </svg>`
        },
        { 
            name: 'email', 
            label: 'Share via Email',
            svg: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
            </svg>`
        }
    ];

    // Function to load social icons
    function loadSocialIcons() {
        socialIconsData.forEach(icon => {
            const socialIcon = document.createElement('a');
            socialIcon.href = '#';
            socialIcon.className = `social-icon ${icon.name}`;
            socialIcon.setAttribute('aria-label', icon.label);
            socialIcon.innerHTML = icon.svg;
            
            socialIconsContainer.appendChild(socialIcon);
        });
        
        // Add event listeners to social icons after they're loaded
        addSocialIconEventListeners();
    }
    
    // Load social icons immediately when page loads
    document.addEventListener('DOMContentLoaded', function() {
        loadSocialIcons();
    });

    // Social Media Sharing Functionality with Click Effects
    function addSocialIconEventListeners() {
        const socialIcons = document.querySelectorAll('.social-icon');
        
        socialIcons.forEach(icon => {
            icon.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Add click animation
                icon.classList.add('clicked');
                setTimeout(() => {
                    icon.classList.remove('clicked');
                }, 400);
                
                const currentUrl = encodeURIComponent(window.location.href);
                const title = encodeURIComponent(document.title);
                const description = encodeURIComponent("Analyze text instantly with Toolivo Text Analyzer. Get accurate counts, readability metrics and detailed insights in one place.");
                
                let shareUrl = '';
                
                if (icon.classList.contains('x-twitter')) {
                    shareUrl = `https://twitter.com/intent/tweet?text=${title}&url=${currentUrl}`;
                } else if (icon.classList.contains('linkedin')) {
                    shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${currentUrl}`;
                } else if (icon.classList.contains('facebook')) {
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${currentUrl}`;
                } else if (icon.classList.contains('whatsapp')) {
                    shareUrl = `https://api.whatsapp.com/send?text=${title}%20${currentUrl}`;
                } else if (icon.classList.contains('telegram')) {
                    shareUrl = `https://t.me/share/url?url=${currentUrl}&text=${title}`;
                } else if (icon.classList.contains('instagram')) {
                    // Instagram doesn't support direct sharing, open profile
                    shareUrl = `https://www.instagram.com/`;
                } else if (icon.classList.contains('reddit')) {
                    shareUrl = `https://reddit.com/submit?url=${currentUrl}&title=${title}`;
                } else if (icon.classList.contains('pinterest')) {
                    shareUrl = `https://pinterest.com/pin/create/button/?url=${currentUrl}&description=${title}`;
                } else if (icon.classList.contains('messenger')) {
                    shareUrl = `https://www.facebook.com/dialog/send?link=${currentUrl}&app_id=YOUR_APP_ID&redirect_uri=${currentUrl}`;
                } else if (icon.classList.contains('email')) {
                    shareUrl = `mailto:?subject=${title}&body=${description}%20${currentUrl}`;
                }
                
                if (shareUrl) {
                    if (icon.classList.contains('email')) {
                        // For email, don't open in new window
                        window.location.href = shareUrl;
                    } else {
                        window.open(shareUrl, '_blank', 'width=600,height=400');
                    }
                }
            });
        });
    }

    // Enhanced FAQ toggle with smooth animation, grouped visibility, and outside-click close
    function initFAQs() {
        const allFAQItems = document.querySelectorAll('.faq-item');
        allFAQItems.forEach(item => {
            const question = item.querySelector('.faq-question');
            if (!question.dataset.initialized) {
                question.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevent triggering outside-click handler
                    const isActive = item.classList.contains('active');
                    // Close all others
                    allFAQItems.forEach(other => {
                        if (other !== item) {
                            other.classList.remove('active');
                        }
                    });
                    // Toggle current
                    item.classList.toggle('active', !isActive);
                });
                question.dataset.initialized = 'true';
            }
            
            // Add keyboard support for FAQ items
            item.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    item.click();
                }
            });
        });
    }

    // Close all FAQs on outside click/tap
    function closeAllFAQs() {
        document.querySelectorAll('.faq-item').forEach(item => {
            item.classList.remove('active');
        });
    }

    // Global outside-click listener
    document.addEventListener('click', (e) => {
        const clickedInsideFAQ = e.target.closest('.faq-item');
        if (!clickedInsideFAQ) {
            closeAllFAQs();
        }
    });

    // Initialize first batch
    initFAQs();

    // Enhanced FAQ "See More" with smooth entry animation
    const seeMoreBtn = document.getElementById('faq-see-more');
    const extraFAQs = document.getElementById('faq-extra');

    if (seeMoreBtn && extraFAQs) {
        seeMoreBtn.addEventListener('click', () => {
            // 1. Reveal container with smooth opacity/transform
            extraFAQs.style.opacity = '0';
            extraFAQs.style.transform = 'translateY(10px)';
            extraFAQs.removeAttribute('hidden');
            
            // Trigger reflow
            void extraFAQs.offsetWidth;
            
            // 2. Animate container in
            extraFAQs.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
            extraFAQs.style.opacity = '1';
            extraFAQs.style.transform = 'translateY(0)';

            // 3. Fade out & remove button smoothly
            seeMoreBtn.style.opacity = '0';
            seeMoreBtn.style.transform = 'scale(0.95)';
            setTimeout(() => {
                seeMoreBtn.style.display = 'none';
            }, 300);

            // 4. Initialize new FAQs
            setTimeout(() => {
                initFAQs();
                
                // 5. Animate each newly revealed FAQ item
                const newItems = extraFAQs.querySelectorAll('.faq-item');
                newItems.forEach((item, i) => {
                    item.style.opacity = '0';
                    item.style.transform = 'translateY(10px)';
                    item.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
                    setTimeout(() => {
                        item.style.opacity = '1';
                        item.style.transform = 'translateY(0)';
                    }, i * 80);
                });
            }, 100);
        });
    }

    function lazyLoadSections() {
  const sections = document.querySelectorAll('.lazy-section');

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        observer.unobserve(entry.target); // stop watching once loaded
      }
    });
  }, {
    // 👇 Load earlier — 100–150px before entering viewport
    rootMargin: '50px 0px',  // vertical margin only; left/right = 0
    threshold: 0.01  // minimal visibility required (more responsive than 0.1)
  });

  sections.forEach(section => {
    // Optional: preload the very first section (e.g., Features)
    // if (section === sections[0]) section.classList.add('visible');
    // else
    observer.observe(section);
  });
}

    // Article "See More" functionality
    document.addEventListener('DOMContentLoaded', () => {
        const btn = document.getElementById('see-more-btn');
        const content = document.getElementById('see-more-content');

        if (btn && content) {
            btn.addEventListener('click', () => {
                // 1. Show the hidden content
                content.removeAttribute('hidden');
                
                // 2. Hide the button completely
                btn.style.display = 'none';
                
                // 3. Optional: smooth scroll to revealed content
                content.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start', 
                    inline: 'nearest' 
                });
                
                // 4. Optional: Add animation to content appearance
                setTimeout(() => {
                    content.style.opacity = '1';
                    content.style.transform = 'translateY(0)';
                }, 10);
            });
        }
    });

    // Back to top functionality
    const backToTopBtn = document.getElementById('backToTop');

    // Show/hide based on scroll
    window.addEventListener('scroll', () => {
        if (window.scrollY > 3000) {
            backToTopBtn.classList.add('show');
        } else {
            backToTopBtn.classList.remove('show');
        }
    });

    // Smooth scroll to top
    backToTopBtn.addEventListener('click', () => {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });

    // Theme toggle visibility on scroll
    document.addEventListener('DOMContentLoaded', () => {
        const themeToggle = document.getElementById('themeToggle');

        if (!themeToggle) {
            console.warn('⚠️ themeToggle not found. Skipping scroll visibility logic.');
            return;
        }

        // Initially hide (in case CSS didn't apply yet)
        themeToggle.classList.remove('visible');

        function updateThemeToggleVisibility() {
            if (window.scrollY > 40) {
                themeToggle.classList.add('visible');
            } else {
                themeToggle.classList.remove('visible');
            }
        }

        // Run on load & scroll
        window.addEventListener('scroll', updateThemeToggleVisibility, { passive: true });
        updateThemeToggleVisibility(); // in case page is reloaded mid-scroll
    });

    // Scroll down 10px on full page load — ensures layout is stable
    window.addEventListener('load', () => {
        // Small delay ensures header, menu, and layout have settled
        setTimeout(() => {
            // Only scroll if at absolute top (e.g. not mid-scroll on refresh)
            if (window.scrollY === 0) {
                window.scrollTo({
                    top: 45,
                    behavior: 'smooth'
                });
            }
        }, 10);
    });

    // Initialize lazy loading
    lazyLoadSections();

    // Function to scroll to tool section
    function scrollToToolSection() {
        const toolSection = document.getElementById('tool-section');
        if (toolSection) {
            toolSection.scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start' 
            });
        }
    }

    // Fix image visibility and lazy loading
    function fixImageVisibility() {
        const images = document.querySelectorAll('.article-image-compact img');
        images.forEach(img => {
            // Ensure images are properly loaded
            if (!img.complete) {
                img.addEventListener('load', function() {
                    this.style.opacity = '1';
                });
                img.style.opacity = '0';
                img.style.transition = 'opacity 0.3s ease';
            }
            
            // Ensure proper image display
            img.style.display = 'block';
            img.style.width = '100%';
            img.style.height = 'auto';
        });
    }

    // Fix images on load
    document.addEventListener('DOMContentLoaded', fixImageVisibility);
    window.addEventListener('load', fixImageVisibility);
    
    // ===== IMAGE CONVERTER TOOL JAVASCRIPT =====

// Main Application State
const state = {
    files: [],
    selectedFiles: new Set(),
    currentIndex: 0,
    isProcessing: false,
    convertedImages: [],
    settings: {
        targetFormat: 'webp',
        compression: 'none',
        quality: 85,
        preserveExif: true,
        privacyMode: false,
        preserveColor: true
    },
    conversionHistory: [],
    currentPreviewImage: null,
    currentPreviewData: null,
    customFilename: null,
    previewImages: [],
    currentPreviewIndex: 0,
    downloadSelections: new Set(),
    objectURLs: new Set(),
    sessionHistoryFiles: new Map(),
    currentHistorySearch: null,
    previewCache: new Map(),
    loadedPreviewImages: new Set(),
    progressInterval: null
};

// DOM Elements
const uploadArea = document.getElementById('uploadArea');
const fileInput = document.getElementById('fileInput');
const browseBtn = document.getElementById('browseBtn');
const fileList = document.getElementById('fileList');
const selectAllBtn = document.getElementById('selectAllBtn');
const deselectAllBtn = document.getElementById('deselectAllBtn');
const clearAllBtn = document.getElementById('clearAllBtn');
const fileCountEl = document.querySelector('.file-count');
const formatOptions = document.querySelectorAll('.format-option');
const compressionTabs = document.querySelectorAll('.compression-tab');
const qualitySlider = document.getElementById('qualitySlider');
const qualityValue = document.getElementById('qualityValue');
const qualitySliderContainer = document.getElementById('qualitySliderContainer');
const settingsToggle = document.getElementById('settingsToggle');
const advancedSettings = document.getElementById('advancedSettings');
const settingsIcon = document.getElementById('settingsIcon');
const preserveExif = document.getElementById('preserveExif');
const privacyMode = document.getElementById('privacyMode');
const preserveColor = document.getElementById('preserveColor');
const historyToggle = document.getElementById('historyToggle');
const historyContent = document.getElementById('historyContent');
const historyIcon = document.getElementById('historyIcon');
const historyItems = document.getElementById('historyItems');
const clearHistoryBtn = document.getElementById('clearHistoryBtn');
const convertBtn = document.getElementById('convertBtn');
const previewBtn = document.getElementById('previewBtn');
const downloadSelectedBtn = document.getElementById('downloadSelectedBtn');
const downloadSingleBtn = document.getElementById('downloadSingleBtn');
const downloadAllBtn = document.getElementById('downloadAllBtn');
const progressContainer = document.getElementById('progressContainer');
const progressFill = document.getElementById('progressFill');
const progressText = document.getElementById('progressText');
const resultsContainer = document.getElementById('resultsContainer');
const convertedCount = document.getElementById('convertedCount');
const totalSavings = document.getElementById('totalSavings');
const targetFormat = document.getElementById('targetFormat');
const modalOverlay = document.getElementById('modalOverlay');
const closeModal = document.getElementById('closeModal');
const modalContent = document.getElementById('modalContent');
const skeletonLoading = document.getElementById('skeletonLoading');
const downloadSelectionModal = document.getElementById('downloadSelectionModal');
const closeDownloadModal = document.getElementById('closeDownloadModal');
const downloadSelectionList = document.getElementById('downloadSelectionList');
const selectAllDownloadBtn = document.getElementById('selectAllDownloadBtn');
const downloadSelectedBtnModal = document.getElementById('downloadSelectedBtnModal');
const settingsSection = document.getElementById('settingsSection');
const settingsContentDiv = document.getElementById('settingsContent');
const uploadPrompt = document.getElementById('uploadPrompt');
const historyMessage = document.getElementById('historyMessage');
const historyMessageText = document.getElementById('historyMessageText');
const historySearchOverlay = document.getElementById('historySearchOverlay');
const historySearchMessage = document.getElementById('historySearchMessage');
const cancelSearchBtn = document.getElementById('cancelSearchBtn');
const browseForFileBtn = document.getElementById('browseForFileBtn');

// Utility Functions
function formatBytes(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function getFileExtension(filename) {
    return filename.slice((filename.lastIndexOf(".") - 1 >>> 0) + 2).toLowerCase();
}

function getMimeType(format) {
    const mimeTypes = {
        'jpg': 'image/jpeg',
        'jpeg': 'image/jpeg',
        'png': 'image/png',
        'gif': 'image/gif',
        'webp': 'image/webp',
        'bmp': 'image/bmp',
        'tiff': 'image/tiff',
        'tif': 'image/tiff'
    };
    return mimeTypes[format] || 'image/jpeg';
}

// Shows 30 characters with extension
function truncateFilename(filename, maxChars = 30) {
    if (filename.length <= maxChars) return filename;
    
    const lastDot = filename.lastIndexOf('.');
    if (lastDot === -1) {
        return filename.substring(0, maxChars - 3) + '...';
    }
    
    const extension = filename.substring(lastDot);
    const nameWithoutExt = filename.substring(0, lastDot);
    
    const charsForName = maxChars - extension.length - 3;
    
    if (charsForName <= 0) {
        return '...' + extension;
    }
    
    if (nameWithoutExt.length <= charsForName) {
        return nameWithoutExt + '...' + extension;
    }
    
    return nameWithoutExt.substring(0, charsForName) + '...' + extension;
}

// Memory Management
function cleanupObjectURLs() {
    state.objectURLs.forEach(url => {
        try {
            URL.revokeObjectURL(url);
        } catch (e) {
            console.warn('Error revoking object URL:', e);
        }
    });
    state.objectURLs.clear();
}

function addObjectURL(url) {
    state.objectURLs.add(url);
    return url;
}

// History Message Banner
function showHistoryMessage(message, isError = false) {
    historyMessageText.textContent = message;
    historyMessage.style.background = isError ? 'var(--error)' : 'var(--success)';
    historyMessage.style.display = 'block';
    
    setTimeout(() => {
        historyMessage.style.display = 'none';
    }, 3000);
}

// File validation
function validateImageFile(file) {
    const maxSize = 50 * 1024 * 1024;
    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp', 'image/bmp', 'image/tiff'];
    
    if (file.size > maxSize) {
        throw new Error(`File "${file.name}" is too large (max 50MB)`);
    }
    
    if (!allowedTypes.includes(file.type)) {
        throw new Error(`File "${file.name}" has unsupported format`);
    }
    
    const sanitizedName = file.name.replace(/[^a-zA-Z0-9._-]/g, '_');
    if (sanitizedName !== file.name) {
        file = new File([file], sanitizedName, { type: file.type });
    }
    
    return file;
}

// Reset to initial state
function resetToInitialState() {
    const actionButtons = document.getElementById('actionButtons');
    actionButtons.classList.remove('converted-state');
    actionButtons.classList.add('initial-state');
    resultsContainer.classList.remove('active');
    state.convertedImages = [];
    updateButtonStates();
    cleanupObjectURLs();
}

// Show all buttons after conversion
function showAllButtons() {
    const actionButtons = document.getElementById('actionButtons');
    actionButtons.classList.remove('initial-state');
    actionButtons.classList.add('converted-state');
}

// Auto-scroll to settings on mobile
function scrollToSettings() {
    const isMobile = window.innerWidth <= 768;
    if (isMobile && state.files.length > 0) {
        setTimeout(() => {
            settingsSection.scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start' 
            });
        }, 100);
    }
}

// Update blur state
function updateBlurState() {
    const hasFiles = state.files.length > 0;
    
    if (settingsSection) {
        if (hasFiles) {
            settingsSection.classList.remove('blurred-section');
            if (settingsContentDiv) {
                settingsContentDiv.style.pointerEvents = 'auto';
                settingsContentDiv.style.opacity = '1';
            }
            if (uploadPrompt) uploadPrompt.style.display = 'none';
        } else {
            settingsSection.classList.add('blurred-section');
            if (settingsContentDiv) {
                settingsContentDiv.style.pointerEvents = 'none';
                settingsContentDiv.style.opacity = '0.7';
            }
            if (uploadPrompt) uploadPrompt.style.display = 'block';
        }
    }
}

// Render file list
function renderFileList() {
    if (state.files.length === 0) {
        fileList.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-images"></i>
                <p>No images uploaded yet</p>
            </div>
        `;
        updateButtonStates();
        updateBlurState();
        return;
    }
    
    fileList.innerHTML = state.files.map((file, index) => `
        <div class="file-item ${state.selectedFiles.has(index) ? 'selected' : ''}" 
             data-index="${index}" 
             role="option" 
             aria-selected="${state.selectedFiles.has(index)}"
             tabindex="0">
            <div class="file-checkbox">
                <i class="fas fa-check"></i>
            </div>
            <div class="file-icon">
                <i class="fas fa-file-image"></i>
            </div>
            <div class="file-info">
                <div class="file-name" title="${file.name}">${truncateFilename(file.name, 25)}</div>
                <div class="file-size">${formatBytes(file.size)} • ${getFileExtension(file.name).toUpperCase()}</div>
            </div>
            <div class="file-actions">
                <button class="file-remove-btn" title="Remove file" aria-label="Remove ${file.name}">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    `).join('');
    
    updateFileCount();
    updateButtonStates();
    updateBlurState();
}

function updateFileCount() {
    const count = state.files.length;
    fileCountEl.textContent = `${count} file${count !== 1 ? 's' : ''}`;
}

// Dynamic button states
function updateButtonStates() {
    const hasFiles = state.files.length > 0;
    const hasSelected = state.selectedFiles.size > 0;
    const singleFile = state.files.length === 1;
    const multipleFiles = state.files.length >= 2;
    const hasConverted = state.convertedImages.length > 0;
    const isInitialState = document.getElementById('actionButtons').classList.contains('initial-state');
    
    if (isInitialState) {
        convertBtn.disabled = !hasSelected;
        previewBtn.disabled = !hasSelected;
        return;
    }
    
    convertBtn.disabled = !hasSelected;
    previewBtn.disabled = !hasSelected;
    
    if (singleFile) {
        downloadSelectedBtn.style.display = 'none';
        downloadSingleBtn.style.display = 'block';
        downloadAllBtn.style.display = 'none';
        downloadSingleBtn.disabled = !hasConverted;
    } else if (multipleFiles) {
        downloadSelectedBtn.style.display = 'block';
        downloadSingleBtn.style.display = 'none';
        downloadAllBtn.style.display = 'block';
        downloadSelectedBtn.disabled = !hasConverted || state.selectedFiles.size === 0;
        downloadAllBtn.disabled = !hasConverted;
    } else {
        downloadSelectedBtn.style.display = 'none';
        downloadSingleBtn.style.display = 'none';
        downloadAllBtn.style.display = 'none';
    }
}

async function addFiles(newFiles) {
    const validFiles = [];
    
    for (const file of newFiles) {
        try {
            const validatedFile = validateImageFile(file);
            
            if (!state.files.some(f => f.name === validatedFile.name && f.size === validatedFile.size)) {
                validFiles.push(validatedFile);
            }
        } catch (error) {
            console.error('File validation error:', error);
            showHistoryMessage(`Error: ${error.message}`, true);
        }
    }
    
    if (validFiles.length === 0) return;
    
    validFiles.forEach(file => state.files.push(file));
    
    for (let i = state.files.length - validFiles.length; i < state.files.length; i++) {
        state.selectedFiles.add(i);
    }
    
    state.convertedImages = [];
    resetToInitialState();
    
    // Auto-scroll to settings for mobile
    scrollToSettings();
    
    // Show skeleton loading for file list
    renderSkeletonFileList(validFiles.length);
    
    setTimeout(() => {
        renderFileList();
        hideResults();
        showHistoryMessage(`Added ${validFiles.length} image${validFiles.length > 1 ? 's' : ''} successfully`);
    }, 300);
}

function renderSkeletonFileList(count) {
    fileList.innerHTML = Array.from({length: count}, () => `
        <div class="file-item-skeleton">
            <div class="skeleton-checkbox"></div>
            <div class="skeleton-icon"></div>
            <div class="skeleton-info">
                <div class="skeleton-name"></div>
                <div class="skeleton-size"></div>
            </div>
        </div>
    `).join('');
}

function hideResults() {
    resultsContainer.classList.remove('active');
    progressContainer.classList.remove('active');
    state.convertedImages = [];
    updateButtonStates();
}

function selectAllFiles() {
    state.files.forEach((_, index) => state.selectedFiles.add(index));
    renderFileList();
    showHistoryMessage('All files selected');
}

function deselectAllFiles() {
    state.selectedFiles.clear();
    renderFileList();
    showHistoryMessage('All files deselected');
}

function clearAllFiles() {
    if (state.files.length === 0) return;
    
    if (confirm('Are you sure you want to clear all uploaded files?')) {
        state.files = [];
        state.selectedFiles.clear();
        state.currentIndex = 0;
        state.convertedImages = [];
        resetToInitialState();
        renderFileList();
        hideResults();
        updateBlurState();
        cleanupObjectURLs();
        showHistoryMessage('All files cleared');
    }
}

// Format selection
function selectFormat(format) {
    formatOptions.forEach(option => {
        const isActive = option.dataset.format === format;
        option.classList.toggle('active', isActive);
        option.setAttribute('aria-checked', isActive);
    });
    
    state.settings.targetFormat = format;
    targetFormat.textContent = format.toUpperCase();
    
    if (state.convertedImages.length > 0) {
        resetToInitialState();
    }
}

// Compression method selection
function selectCompression(method) {
    compressionTabs.forEach(tab => {
        const isActive = tab.dataset.compression === method;
        tab.classList.toggle('active', isActive);
        tab.setAttribute('aria-selected', isActive);
    });
    
    state.settings.compression = method;
    
    if (method === 'select') {
        qualitySliderContainer.style.display = 'block';
    } else {
        qualitySliderContainer.style.display = 'none';
    }
    
    if (state.convertedImages.length > 0) {
        resetToInitialState();
    }
}

// Update quality slider
function updateQualityDisplay() {
    const quality = parseInt(qualitySlider.value);
    qualityValue.textContent = `${quality}%`;
    state.settings.quality = quality;
}

// Image conversion function
async function convertImage(file, targetFormat, settings) {
    const cacheKey = `${file.name}-${file.size}-${targetFormat}-${settings.compression}-${settings.quality}`;
    if (state.previewCache.has(cacheKey)) {
        const cached = state.previewCache.get(cacheKey);
        return {
            ...cached,
            original: file,
            converted: new Blob([cached.converted], { type: cached.converted.type })
        };
    }
    
    return new Promise((resolve, reject) => {
        const img = new Image();
        const reader = new FileReader();
        
        reader.onload = (e) => {
            img.src = e.target.result;
            img.onload = () => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                canvas.width = img.width;
                canvas.height = img.height;
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                let quality = 1.0;
                if (settings.compression === 'smart') {
                    const originalSizeKB = file.size / 1024;
                    if (originalSizeKB > 1000) quality = 0.7;
                    else if (originalSizeKB > 500) quality = 0.8;
                    else if (originalSizeKB > 100) quality = 0.9;
                    else quality = 0.95;
                } else if (settings.compression === 'select') {
                    quality = settings.quality / 100;
                }
                
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                
                const mimeType = getMimeType(targetFormat);
                
                if (targetFormat === 'jpg' || targetFormat === 'jpeg') {
                    const tempCanvas = document.createElement('canvas');
                    const tempCtx = tempCanvas.getContext('2d');
                    tempCanvas.width = canvas.width;
                    tempCanvas.height = canvas.height;
                    
                    tempCtx.fillStyle = '#ffffff';
                    tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                    tempCtx.drawImage(img, 0, 0);
                    
                    tempCanvas.toBlob((blob) => {
                        const result = {
                            original: file,
                            converted: blob,
                            originalSize: file.size,
                            convertedSize: blob.size,
                            originalFormat: getFileExtension(file.name),
                            targetFormat: targetFormat,
                            width: img.width,
                            height: img.height,
                            savings: ((file.size - blob.size) / file.size * 100).toFixed(1),
                            quality: quality
                        };
                        
                        state.previewCache.set(cacheKey, {
                            ...result,
                            converted: blob
                        });
                        
                        resolve(result);
                    }, mimeType, quality);
                } else {
                    canvas.toBlob((blob) => {
                        const result = {
                            original: file,
                            converted: blob,
                            originalSize: file.size,
                            convertedSize: blob.size,
                            originalFormat: getFileExtension(file.name),
                            targetFormat: targetFormat,
                            width: img.width,
                            height: img.height,
                            savings: ((file.size - blob.size) / file.size * 100).toFixed(1),
                            quality: quality
                        };
                        
                        state.previewCache.set(cacheKey, {
                            ...result,
                            converted: blob
                        });
                        
                        resolve(result);
                    }, mimeType, quality);
                }
            };
            
            img.onerror = () => reject(new Error('Failed to load image'));
        };
        
        reader.onerror = () => reject(new Error('Failed to read file'));
        reader.readAsDataURL(file);
    });
}

// Convert selected images
async function convertSelectedImages() {
    if (state.files.length === 0 || state.selectedFiles.size === 0) {
        showHistoryMessage('Please select images to convert', true);
        return;
    }
    
    if (state.isProcessing) {
        showHistoryMessage('Conversion already in progress', true);
        return;
    }
    
    const originalText = convertBtn.innerHTML;
    convertBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Converting...';
    convertBtn.disabled = true;
    previewBtn.disabled = true;
    
    progressContainer.classList.add('active');
    resultsContainer.classList.remove('active');
    
    state.isProcessing = true;
    
    const filesToProcess = Array.from(state.selectedFiles)
        .map(index => state.files[index]);
    const totalFiles = filesToProcess.length;
    
    state.convertedImages = [];
    cleanupObjectURLs();
    
    let totalOriginalSize = 0;
    let totalConvertedSize = 0;
    let processedCount = 0;
    let errors = [];
    
    // Start progress animation
    let progress = 0;
    if (state.progressInterval) clearInterval(state.progressInterval);
    state.progressInterval = setInterval(() => {
        if (progress >= 90) {
            clearInterval(state.progressInterval);
            return;
        }
        progress += 1;
        progressFill.style.width = `${progress}%`;
        progressText.textContent = `${progress}% (${processedCount}/${totalFiles})`;
    }, 100);
    
    for (let i = 0; i < filesToProcess.length; i++) {
        const file = filesToProcess[i];
        
        try {
            const result = await convertImage(file, state.settings.targetFormat, state.settings);
            state.convertedImages.push(result);
            
            totalOriginalSize += result.originalSize;
            totalConvertedSize += result.convertedSize;
            
            addToHistory(result);
            processedCount++;
            
        } catch (error) {
            console.error('Error converting image:', error);
            errors.push({
                file: file.name,
                error: error.message
            });
            processedCount++;
        }
        
        // Update real progress
        const realProgress = Math.round((processedCount / totalFiles) * 90);
        progressFill.style.width = `${realProgress}%`;
        progressText.textContent = `${realProgress}% (${processedCount}/${totalFiles})`;
    }
    
    // Clear progress animation
    if (state.progressInterval) {
        clearInterval(state.progressInterval);
        state.progressInterval = null;
    }
    
    // Complete progress
    progressFill.style.width = '100%';
    progressText.textContent = `100% (${processedCount}/${totalFiles})`;
    
    // Show results
    setTimeout(() => {
        showAllButtons();
        
        if (state.convertedImages.length > 0) {
            showResults(totalOriginalSize, totalConvertedSize);
            
            if (errors.length > 0) {
                showHistoryMessage(`Converted ${state.convertedImages.length} images. ${errors.length} failed.`, false);
            } else {
                showHistoryMessage(`Successfully converted ${state.convertedImages.length} images!`, false);
            }
        } else if (errors.length > 0) {
            showHistoryMessage('Conversion failed for all selected images', true);
        }
        
        convertBtn.innerHTML = originalText;
        convertBtn.disabled = false;
        previewBtn.disabled = false;
        
        updateButtonStates();
        state.isProcessing = false;
        progressContainer.classList.remove('active');
    }, 500);
}

function showResults(totalOriginalSize, totalConvertedSize) {
    if (state.convertedImages.length === 0) return;
    
    const savingsPercent = parseFloat(((totalOriginalSize - totalConvertedSize) / totalOriginalSize * 100).toFixed(1));
    
    convertedCount.textContent = state.convertedImages.length;
    totalSavings.textContent = `${savingsPercent}%`;
    targetFormat.textContent = state.settings.targetFormat.toUpperCase();
    
    resultsContainer.classList.add('active');
    state.isProcessing = false;
    progressContainer.classList.remove('active');
}

// Download single converted image
function downloadConvertedImage() {
    if (state.convertedImages.length === 0) {
        showHistoryMessage('No converted images available', true);
        return;
    }
    
    const image = state.convertedImages[0];
    const link = document.createElement('a');
    const url = URL.createObjectURL(image.converted);
    addObjectURL(url);
    link.href = url;
    
    const nameWithoutExt = image.original.name.replace(/\.[^/.]+$/, '');
    const fileName = state.customFilename ? `${state.customFilename}.${state.settings.targetFormat}` : `${nameWithoutExt}.${state.settings.targetFormat}`;
    
    link.download = fileName;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    showHistoryMessage('Image downloaded successfully');
}

// Show download selection modal
function showDownloadSelection() {
    if (state.convertedImages.length === 0) {
        showHistoryMessage('No converted images available', true);
        return;
    }
    
    state.downloadSelections = new Set();
    
    downloadSelectionList.innerHTML = state.convertedImages.map((image, index) => `
        <div class="download-selection-item" data-index="${index}">
            <input type="checkbox" class="download-selection-checkbox" id="downloadCheckbox${index}" 
                   data-index="${index}" checked>
            <div class="download-selection-info">
                <div class="download-selection-name">
                    ${truncateFilename(image.original.name.replace(/\.[^/.]+$/, '') + '.' + state.settings.targetFormat, 30)}
                </div>
                <div class="download-selection-details">
                    <span>${formatBytes(image.convertedSize)}</span>
                    <span>•</span>
                    <span style="color: var(--success); font-weight: 600;">${image.savings}% saved</span>
                </div>
            </div>
        </div>
    `).join('');
    
    state.convertedImages.forEach((_, index) => {
        state.downloadSelections.add(index);
    });
    
    downloadSelectionModal.style.display = 'flex';
}

// Download selected converted images from modal
function downloadSelectedFromModal() {
    if (state.downloadSelections.size === 0) {
        showHistoryMessage('Please select at least one image to download', true);
        return;
    }
    
    const selectedImages = Array.from(state.downloadSelections)
        .map(index => state.convertedImages[index]);
    
    if (selectedImages.length === 1) {
        const image = selectedImages[0];
        const link = document.createElement('a');
        const url = URL.createObjectURL(image.converted);
        addObjectURL(url);
        link.href = url;
        
        const nameWithoutExt = image.original.name.replace(/\.[^/.]+$/, '');
        const fileName = `${nameWithoutExt}.${state.settings.targetFormat}`;
        
        link.download = fileName;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showHistoryMessage('Image downloaded successfully');
    } else {
        downloadMultipleAsZip(selectedImages, 'selected_images.zip');
    }
    
    downloadSelectionModal.style.display = 'none';
}

// Download all converted images as ZIP
async function downloadAllConvertedImages() {
    if (state.convertedImages.length === 0) {
        showHistoryMessage('No converted images available', true);
        return;
    }
    
    if (state.convertedImages.length === 1) {
        // If only one image, download it directly
        downloadConvertedImage();
    } else {
        downloadMultipleAsZip(state.convertedImages, 'converted_images.zip');
    }
}

// Helper function to download multiple images as ZIP
async function downloadMultipleAsZip(images, zipName) {
    showHistoryMessage('Creating ZIP archive...', false);
    
    const zip = new JSZip();
    const folder = zip.folder(zipName.replace('.zip', ''));
    
    for (let i = 0; i < images.length; i++) {
        const image = images[i];
        
        try {
            const url = URL.createObjectURL(image.converted);
            addObjectURL(url);
            const response = await fetch(url);
            const blob = await response.blob();
            
            const nameWithoutExt = image.original.name.replace(/\.[^/.]+$/, '');
            const fileName = `${nameWithoutExt}.${state.settings.targetFormat}`;
            
            folder.file(fileName, blob);
        } catch (error) {
            console.error('Error adding image to ZIP:', error);
        }
    }
    
    try {
        const content = await zip.generateAsync({type: "blob"});
        saveAs(content, zipName);
        showHistoryMessage('ZIP downloaded successfully!', false);
    } catch (error) {
        console.error('Error creating ZIP:', error);
        showHistoryMessage('Failed to create ZIP file', true);
    }
}

// Show image skeleton loader in preview
function showImageSkeletonLoader(container) {
    if (!container) return;
    
    let skeleton = container.querySelector('.image-skeleton-loader');
    if (!skeleton) {
        skeleton = document.createElement('div');
        skeleton.className = 'image-skeleton-loader';
        skeleton.innerHTML = `
            <i class="fas fa-spinner fa-spin"></i>
            <span>Loading image...</span>
        `;
        container.appendChild(skeleton);
    }
    
    container.classList.add('loading');
    skeleton.classList.add('active');
}

// Hide image skeleton loader
function hideImageSkeletonLoader(container) {
    if (!container) return;
    
    const skeleton = container.querySelector('.image-skeleton-loader');
    if (skeleton) {
        skeleton.classList.remove('active');
    }
    container.classList.remove('loading');
}

// Preview conversion in modal
async function previewConversion() {
    if (state.files.length === 0 || state.selectedFiles.size === 0) {
        showHistoryMessage('Please select images to preview', true);
        return;
    }
    
    const selectedIndices = Array.from(state.selectedFiles);
    state.previewImages = selectedIndices.map(index => state.files[index]);
    state.currentPreviewIndex = 0;
    state.loadedPreviewImages.clear();
    
    modalOverlay.style.display = 'flex';
    skeletonLoading.classList.add('active');
    
    await loadPreviewImage(0);
}

// Load preview image at specific index
async function loadPreviewImage(index) {
    if (index < 0 || index >= state.previewImages.length) return;
    
    state.currentPreviewIndex = index;
    
    try {
        const file = state.previewImages[index];
        state.currentPreviewImage = file;
        
        const isAlreadyLoaded = state.loadedPreviewImages.has(index);
        
        if (!isAlreadyLoaded) {
            const result = await convertImage(file, state.settings.targetFormat, state.settings);
            state.currentPreviewData = result;
            state.loadedPreviewImages.add(index);
        } else {
            const cacheKey = `${file.name}-${file.size}-${state.settings.targetFormat}-${state.settings.compression}-${state.settings.quality}`;
            if (state.previewCache.has(cacheKey)) {
                const cached = state.previewCache.get(cacheKey);
                state.currentPreviewData = {
                    ...cached,
                    original: file
                };
            }
        }
        
        state.customFilename = file.name.replace(/\.[^/.]+$/, '');
        
        const originalReader = new FileReader();
        originalReader.onload = async (e) => {
            const originalDataUrl = e.target.result;
            let convertedUrl;
            
            if (state.currentPreviewData) {
                convertedUrl = URL.createObjectURL(state.currentPreviewData.converted);
                addObjectURL(convertedUrl);
            }
            
            // Render modal content - Shows 30 chars with extension
            modalContent.innerHTML = `
                <div class="comparison-container" id="comparisonContainer">
                    ${!isAlreadyLoaded ? `
                    <div class="image-skeleton-loader active">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>Loading image...</span>
                    </div>
                    ` : ''}
                    
                    <span class="comparison-label label-original-comparison">Original (${getFileExtension(file.name).toUpperCase()})</span>
                    <span class="comparison-label label-converted-comparison">Converted (${state.settings.targetFormat.toUpperCase()})</span>
                    <img src="${originalDataUrl}" class="comparison-image img-original" alt="Original" style="${!isAlreadyLoaded ? 'opacity: 0.3;' : 'opacity: 1;'}">
                    ${state.currentPreviewData ? `<img src="${convertedUrl}" class="comparison-image img-converted" alt="Converted" style="${!isAlreadyLoaded ? 'opacity: 0.3;' : 'opacity: 1;'} clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%);">` : ''}
                    <div class="slider-handle-comparison" id="comparisonHandle"></div>
                    
                    <!-- Image Counter -->
                    <div class="nav-counter">
                        <i class="fas fa-images"></i>
                        <span>${index + 1} / ${state.previewImages.length}</span>
                    </div>
                </div>
                
                <!-- Navigation arrows - hide if only one image -->
                ${state.previewImages.length > 1 ? `
                <div class="slider-controls">
                    <button class="arrow-btn" id="prevArrow" ${index === 0 ? 'disabled' : ''} aria-label="Previous image">
                        <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M15 18l-6-6 6-6"></path>
                        </svg>
                    </button>
                    <button class="arrow-btn" id="nextArrow" ${index === state.previewImages.length - 1 ? 'disabled' : ''} aria-label="Next image">
                        <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 18l6-6-6-6"></path>
                        </svg>
                    </button>
                </div>
                ` : '<div class="slider-controls hidden"></div>'}
                
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-header">
                            <i class="fas fa-file-image"></i>
                            Original Image Details
                        </div>
                        <ul class="stat-list">
                            <li class="stat-item">
                                <span class="stat-label-modal">File Name:</span>
                                <span class="stat-value-modal truncate-filename" title="${file.name}">${truncateFilename(file.name, 30)}</span>
                            </li>
                            <li class="stat-item">
                                <span class="stat-label-modal">File Size:</span>
                                <span class="stat-value-modal">${formatBytes(state.currentPreviewData ? state.currentPreviewData.originalSize : file.size)}</span>
                            </li>
                            <li class="stat-item">
                                <span class="stat-label-modal">Dimensions:</span>
                                <span class="stat-value-modal">${state.currentPreviewData ? state.currentPreviewData.width : 'Loading...'} × ${state.currentPreviewData ? state.currentPreviewData.height : 'Loading...'}</span>
                            </li>
                            <li class="stat-item">
                                <span class="stat-label-modal">Format:</span>
                                <span class="stat-value-modal">${getFileExtension(file.name).toUpperCase()}</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-header">
                            <i class="fas fa-exchange-alt"></i>
                            Converted Image Details
                        </div>
                        <ul class="stat-list">
                            <li class="stat-item">
                                <span class="stat-label-modal">File Size:</span>
                                <span class="stat-value-modal">${state.currentPreviewData ? formatBytes(state.currentPreviewData.convertedSize) : 'Loading...'}</span>
                            </li>
                            <li class="stat-item">
                                <span class="stat-label-modal">Size Reduction:</span>
                                <span class="stat-value-modal success">${state.currentPreviewData ? state.currentPreviewData.savings + '%' : 'Loading...'}</span>
                            </li>
                            <li class="stat-item">
                                <span class="stat-label-modal">Quality Level:</span>
                                <span class="stat-value-modal">${state.currentPreviewData ? Math.round(state.currentPreviewData.quality * 100) + '%' : 'Loading...'}</span>
                            </li>
                            <li class="stat-item">
                                <span class="stat-label-modal">New Format:</span>
                                <span class="stat-value-modal">${state.settings.targetFormat.toUpperCase()}</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="rename-section">
                    <div class="rename-header">
                        <i class="fas fa-file-signature"></i>
                        Rename File
                    </div>
                    <div class="rename-input-group">
                        <input type="text" class="rename-input" id="renameInput" 
                               value="${state.customFilename}"
                               placeholder="Enter filename">
                        <span class="rename-extension">.${state.settings.targetFormat}</span>
                        <button class="btn btn-primary" id="renameBtn">
                            <i class="fas fa-edit"></i> Rename It
                        </button>
                    </div>
                    <p style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">
                        New filename will be used when downloading
                    </p>
                </div>
                
                <div class="modal-actions">
                    <button class="action-btn secondary" id="downloadPreviewBtn" ${!state.currentPreviewData ? 'disabled' : ''}>
                        <i class="fas fa-download"></i> Download This Image
                    </button>
                    <button class="action-btn" id="downloadAllZipPreviewBtn">
                        <i class="fas fa-file-archive"></i> Download All as ZIP
                    </button>
                </div>
            `;
            
            skeletonLoading.classList.remove('active');
            
            if (isAlreadyLoaded) {
                const comparisonContainer = document.getElementById('comparisonContainer');
                if (comparisonContainer) {
                    hideImageSkeletonLoader(comparisonContainer);
                }
                setupComparisonSlider();
            } else {
                const originalImg = modalContent.querySelector('.img-original');
                const convertedImg = modalContent.querySelector('.img-converted');
                const comparisonContainer = document.getElementById('comparisonContainer');
                
                let imagesLoaded = 0;
                const totalImages = 2;
                
                function onImageLoad() {
                    imagesLoaded++;
                    if (imagesLoaded === totalImages) {
                        setTimeout(() => {
                            hideImageSkeletonLoader(comparisonContainer);
                            if (originalImg) originalImg.style.opacity = '1';
                            if (convertedImg) convertedImg.style.opacity = '1';
                            setupComparisonSlider();
                        }, 300);
                    }
                }
                
                originalImg.onload = onImageLoad;
                if (convertedImg) convertedImg.onload = onImageLoad;
                
                if (originalImg.complete && (!convertedImg || convertedImg.complete)) {
                    imagesLoaded = totalImages;
                    setTimeout(() => {
                        hideImageSkeletonLoader(comparisonContainer);
                        if (originalImg) originalImg.style.opacity = '1';
                        if (convertedImg) convertedImg.style.opacity = '1';
                        setupComparisonSlider();
                    }, 300);
                }
            }
            
            // Setup event listeners for navigation
            const prevArrow = document.getElementById('prevArrow');
            const nextArrow = document.getElementById('nextArrow');
            const renameInput = document.getElementById('renameInput');
            const renameBtn = document.getElementById('renameBtn');
            const downloadPreviewBtn = document.getElementById('downloadPreviewBtn');
            const downloadAllZipPreviewBtn = document.getElementById('downloadAllZipPreviewBtn');
            
            if (prevArrow) {
                prevArrow.addEventListener('click', async () => {
                    if (index > 0) {
                        const nextIndex = index - 1;
                        if (!state.loadedPreviewImages.has(nextIndex)) {
                            const container = document.getElementById('comparisonContainer');
                            showImageSkeletonLoader(container);
                        }
                        await loadPreviewImage(nextIndex);
                    }
                });
            }
            
            if (nextArrow) {
                nextArrow.addEventListener('click', async () => {
                    if (index < state.previewImages.length - 1) {
                        const nextIndex = index + 1;
                        if (!state.loadedPreviewImages.has(nextIndex)) {
                            const container = document.getElementById('comparisonContainer');
                            showImageSkeletonLoader(container);
                        }
                        await loadPreviewImage(nextIndex);
                    }
                });
            }
            
            renameBtn.addEventListener('click', () => {
                const newName = renameInput.value.trim();
                if (newName) {
                    state.customFilename = newName;
                    showHistoryMessage('Filename saved for download');
                }
            });
            
            downloadPreviewBtn.addEventListener('click', () => {
                if (state.currentPreviewData && convertedUrl) {
                    const link = document.createElement('a');
                    link.href = convertedUrl;
                    link.download = `${state.customFilename}.${state.settings.targetFormat}`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    showHistoryMessage('Image downloaded from preview');
                }
            });
            
            downloadAllZipPreviewBtn.addEventListener('click', () => {
                modalOverlay.style.display = 'none';
                downloadAllConvertedImages();
            });
            
        };
        originalReader.readAsDataURL(file);
        
    } catch (error) {
        console.error('Error generating preview:', error);
        skeletonLoading.classList.remove('active');
        const container = document.getElementById('comparisonContainer');
        if (container) hideImageSkeletonLoader(container);
        showHistoryMessage('Failed to load preview', true);
    }
}

// Comparison slider setup
function setupComparisonSlider() {
    const container = document.getElementById('comparisonContainer');
    const handle = document.getElementById('comparisonHandle');
    const convertedImg = container?.querySelector('.img-converted');
    
    if (!container || !handle || !convertedImg) return;
    
    let isDragging = false;
    
    function updateSlider(clientX) {
        const rect = container.getBoundingClientRect();
        let x = ((clientX - rect.left) / rect.width) * 100;
        x = Math.max(0, Math.min(x, 100));
        convertedImg.style.clipPath = `polygon(0 0, ${x}% 0, ${x}% 100%, 0 100%)`;
        handle.style.left = `${x}%`;
    }
    
    handle.addEventListener('mousedown', (e) => {
        isDragging = true;
        e.preventDefault();
    });
    
    document.addEventListener('mousemove', (e) => {
        if (isDragging) updateSlider(e.clientX);
    });
    
    document.addEventListener('mouseup', () => {
        isDragging = false;
    });
    
    handle.addEventListener('touchstart', (e) => {
        isDragging = true;
        e.preventDefault();
    });
    
    document.addEventListener('touchmove', (e) => {
        if (isDragging && e.touches[0]) {
            updateSlider(e.touches[0].clientX);
        }
    });
    
    document.addEventListener('touchend', () => {
        isDragging = false;
    });
    
    container.addEventListener('click', (e) => {
        updateSlider(e.clientX);
    });
    
    updateSlider(container.getBoundingClientRect().left + container.offsetWidth / 2);
}

// History management
const historyManager = {
    loadHistory() {
        const savedHistory = localStorage.getItem('imageConverterHistory');
        if (savedHistory) {
            try {
                state.conversionHistory = JSON.parse(savedHistory);
                this.cleanOldEntries();
                this.renderHistory();
            } catch (e) {
                console.error('Error loading history:', e);
                state.conversionHistory = [];
            }
        }
    },
    
    cleanOldEntries() {
        const twentyFourHoursAgo = Date.now() - (24 * 60 * 60 * 1000);
        const oldLength = state.conversionHistory.length;
        state.conversionHistory = state.conversionHistory.filter(
            item => item.timestamp > twentyFourHoursAgo
        );
        
        if (oldLength !== state.conversionHistory.length) {
            this.saveHistory();
        }
    },
    
    saveHistory() {
        localStorage.setItem('imageConverterHistory', JSON.stringify(state.conversionHistory));
    },
    
    addToHistory(conversion) {
        const historyItem = {
            id: Date.now(),
            timestamp: Date.now(),
            originalName: conversion.original.name,
            originalFormat: conversion.originalFormat,
            targetFormat: conversion.targetFormat,
            originalSize: conversion.originalSize,
            convertedSize: conversion.convertedSize,
            savings: conversion.savings,
            metadata: {
                name: conversion.original.name,
                size: conversion.original.size,
                type: conversion.original.type,
                lastModified: conversion.original.lastModified
            }
        };
        
        state.sessionHistoryFiles.set(historyItem.id, conversion.original);
        
        state.conversionHistory.unshift(historyItem);
        
        if (state.conversionHistory.length > 20) {
            const removed = state.conversionHistory.pop();
            state.sessionHistoryFiles.delete(removed.id);
        }
        
        this.saveHistory();
        this.renderHistory();
    },
    
    renderHistory() {
        if (state.conversionHistory.length === 0) {
            historyItems.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-clock"></i>
                    <p>No conversion history yet</p>
                </div>
            `;
            return;
        }
        
        historyItems.innerHTML = state.conversionHistory.map((item) => `
            <div class="history-item" data-id="${item.id}" role="button" tabindex="0">
                <div class="history-info">
                    <div class="history-icon">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <div class="history-text">
                        <div class="history-filename" title="${item.originalName}">${truncateFilename(item.originalName, 25)}</div>
                        <div class="history-details">
                            <span class="history-format">${item.originalFormat.toUpperCase()} → ${item.targetFormat.toUpperCase()}</span> • 
                            <span class="history-size">${item.savings}% saved</span>
                        </div>
                    </div>
                </div>
                <div class="history-time">
                    ${formatTime(item.timestamp)}
                </div>
            </div>
        `).join('');
        
        // Setup history item click handlers
        this.setupHistoryClickHandlers();
    },
    
    // Clean, simple history click handler
    setupHistoryClickHandlers() {
        document.querySelectorAll('.history-item').forEach(item => {
            item.addEventListener('click', async () => {
                const historyId = parseInt(item.dataset.id);
                const historyItem = state.conversionHistory.find(h => h.id === historyId);
                
                if (historyItem) {
                    // Show simple selection overlay
                    state.currentHistorySearch = historyItem;
                    historySearchOverlay.style.display = 'flex';
                    
                    // Clean, minimal message
                    historySearchMessage.innerHTML = `
                        <div style="margin-bottom: 15px; color: var(--text-secondary);">
                            Select: <strong style="color: var(--blue-700);">${truncateFilename(historyItem.originalName, 35)}</strong>
                        </div>
                        <div style="font-size: 13px; color: var(--text-secondary);">
                            Click "Browse Files" to select this image
                        </div>
                    `;
                }
            });
        });
    },
    
    clearHistory() {
        if (state.conversionHistory.length === 0) {
            showHistoryMessage('History is already empty', true);
            return;
        }
        
        if (confirm('Are you sure you want to clear all conversion history? This cannot be undone.')) {
            state.conversionHistory = [];
            state.sessionHistoryFiles.clear();
            this.saveHistory();
            this.renderHistory();
            showHistoryMessage('History cleared successfully');
        }
    }
};

function addToHistory(conversion) {
    historyManager.addToHistory(conversion);
}

function formatTime(timestamp) {
    const now = Date.now();
    const diff = now - timestamp;
    const minutes = Math.floor(diff / 60000);
    const hours = Math.floor(diff / 3600000);
    const days = Math.floor(diff / 86400000);
    
    if (minutes < 1) return 'Just now';
    if (minutes < 60) return `${minutes}m ago`;
    if (hours < 24) return `${hours}h ago`;
    return `${days}d ago`;
}

function clearHistory() {
    historyManager.clearHistory();
}

// Toggle history dropdown
function toggleHistory() {
    const isActive = historyContent.classList.toggle('active');
    historyIcon.classList.toggle('fa-chevron-down', !isActive);
    historyIcon.classList.toggle('fa-chevron-up', isActive);
    historyContent.setAttribute('aria-hidden', !isActive);
    historyToggle.setAttribute('aria-expanded', isActive);
}

// Cancel file search function
function cancelFileSearch() {
    historySearchOverlay.style.display = 'none';
    state.currentHistorySearch = null;
}

// Event Listeners
function setupEventListeners() {
    browseBtn.addEventListener('click', () => fileInput.click());
    
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = 'var(--blue-600)';
        uploadArea.style.background = 'rgba(37, 99, 235, 0.1)';
    });
    
    uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = 'var(--blue-600)';
        uploadArea.style.background = 'rgba(37, 99, 235, 0.05)';
    });
    
    uploadArea.addEventListener('drop', async (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = 'var(--blue-600)';
        uploadArea.style.background = 'rgba(37, 99, 235, 0.05)';
        const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
        if (files.length > 0) {
            await addFiles(files);
        }
    });

    uploadArea.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            fileInput.click();
        }
    });

    fileInput.addEventListener('change', async function(e) {
        const files = Array.from(e.target.files);
        if (files.length > 0) {
            await addFiles(files);
            this.value = '';
            
            // Auto-close the history search popup when browsing files
            if (historySearchOverlay.style.display === 'flex') {
                historySearchOverlay.style.display = 'none';
                state.currentHistorySearch = null;
            }
        }
    });

    selectAllBtn.addEventListener('click', selectAllFiles);
    deselectAllBtn.addEventListener('click', deselectAllFiles);
    clearAllBtn.addEventListener('click', clearAllFiles);
    historyToggle.addEventListener('click', toggleHistory);
    clearHistoryBtn.addEventListener('click', clearHistory);

    // Made entire file item clickable for selection
    fileList.addEventListener('click', (e) => {
        const fileItem = e.target.closest('.file-item');
        if (!fileItem) return;
        
        const index = parseInt(fileItem.dataset.index);
        
        if (e.target.closest('.file-remove-btn')) {
            e.stopPropagation();
            if (confirm('Remove this image from the list?')) {
                state.files.splice(index, 1);
                state.selectedFiles.delete(index);
                
                const newSelected = new Set();
                state.selectedFiles.forEach(value => {
                    if (value > index) {
                        newSelected.add(value - 1);
                    } else if (value < index) {
                        newSelected.add(value);
                    }
                });
                state.selectedFiles = newSelected;
                
                state.convertedImages = [];
                resetToInitialState();
                
                renderFileList();
                showHistoryMessage('Image removed');
            }
        } else {
            // Select/deselect when clicking anywhere on the file-item
            if (state.selectedFiles.has(index)) {
                state.selectedFiles.delete(index);
            } else {
                state.selectedFiles.add(index);
            }
            renderFileList();
        }
    });

    fileList.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const fileItem = e.target.closest('.file-item');
            if (fileItem) {
                const index = parseInt(fileItem.dataset.index);
                if (state.selectedFiles.has(index)) {
                    state.selectedFiles.delete(index);
                } else {
                    state.selectedFiles.add(index);
                }
                renderFileList();
            }
        }
    });

    formatOptions.forEach(option => {
        option.addEventListener('click', () => selectFormat(option.dataset.format));
        option.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                selectFormat(option.dataset.format);
            }
        });
    });

    compressionTabs.forEach(tab => {
        tab.addEventListener('click', () => selectCompression(tab.dataset.compression));
        tab.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                selectCompression(tab.dataset.compression);
            }
        });
    });

    qualitySlider.addEventListener('input', updateQualityDisplay);

    settingsToggle.addEventListener('click', () => {
        const isActive = advancedSettings.classList.toggle('active');
        settingsIcon.classList.toggle('fa-chevron-down', !isActive);
        settingsIcon.classList.toggle('fa-chevron-up', isActive);
        advancedSettings.setAttribute('aria-hidden', !isActive);
        settingsToggle.setAttribute('aria-expanded', isActive);
    });

    preserveExif.addEventListener('change', () => {
        state.settings.preserveExif = preserveExif.checked;
        if (preserveExif.checked) {
            privacyMode.checked = false;
            state.settings.privacyMode = false;
        }
        
        if (state.convertedImages.length > 0) {
            resetToInitialState();
        }
    });

    privacyMode.addEventListener('change', () => {
        state.settings.privacyMode = privacyMode.checked;
        if (privacyMode.checked) {
            preserveExif.checked = false;
            state.settings.preserveExif = false;
        }
        
        if (state.convertedImages.length > 0) {
            resetToInitialState();
        }
    });

    preserveColor.addEventListener('change', () => {
        state.settings.preserveColor = preserveColor.checked;
        
        if (state.convertedImages.length > 0) {
            resetToInitialState();
        }
    });

    previewBtn.addEventListener('click', previewConversion);
    convertBtn.addEventListener('click', convertSelectedImages);
    downloadSingleBtn.addEventListener('click', downloadConvertedImage);
    downloadSelectedBtn.addEventListener('click', showDownloadSelection);
    downloadAllBtn.addEventListener('click', downloadAllConvertedImages);

    closeModal.addEventListener('click', () => {
        modalOverlay.style.display = 'none';
        cleanupObjectURLs();
    });
    
    modalOverlay.addEventListener('click', (e) => {
        if (e.target === modalOverlay) {
            modalOverlay.style.display = 'none';
            cleanupObjectURLs();
        }
    });

    closeDownloadModal.addEventListener('click', () => {
        downloadSelectionModal.style.display = 'none';
    });
    
    downloadSelectionModal.addEventListener('click', (e) => {
        if (e.target === downloadSelectionModal) {
            downloadSelectionModal.style.display = 'none';
        }
    });
    
    // Made entire download selection item clickable
    downloadSelectionList.addEventListener('click', (e) => {
        const listItem = e.target.closest('.download-selection-item');
        if (!listItem) return;
        
        const checkbox = listItem.querySelector('.download-selection-checkbox');
        if (checkbox) {
            const index = parseInt(checkbox.dataset.index);
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                state.downloadSelections.add(index);
            } else {
                state.downloadSelections.delete(index);
            }
            
            // Update Select All button text
            const allChecked = Array.from(downloadSelectionList.querySelectorAll('.download-selection-checkbox')).every(cb => cb.checked);
            selectAllDownloadBtn.innerHTML = allChecked ? 
                '<i class="fas fa-times"></i> Deselect All' : 
                '<i class="fas fa-check"></i> Select All';
        }
    });
    
    selectAllDownloadBtn.addEventListener('click', () => {
        const checkboxes = downloadSelectionList.querySelectorAll('.download-selection-checkbox');
        const allChecked = Array.from(checkboxes).every(cb => cb.checked);
        
        checkboxes.forEach(cb => {
            cb.checked = !allChecked;
            const index = parseInt(cb.dataset.index);
            if (!allChecked) {
                state.downloadSelections.add(index);
            } else {
                state.downloadSelections.delete(index);
            }
        });
        
        selectAllDownloadBtn.innerHTML = allChecked ? 
            '<i class="fas fa-check"></i> Select All' : 
            '<i class="fas fa-times"></i> Deselect All';
    });
    
    downloadSelectedBtnModal.addEventListener('click', downloadSelectedFromModal);

    cancelSearchBtn.addEventListener('click', cancelFileSearch);
    
    // Browse button closes popup immediately
    browseForFileBtn.addEventListener('click', () => {
        // Close the popup first
        historySearchOverlay.style.display = 'none';
        state.currentHistorySearch = null;
        
        // Then open file browser
        fileInput.click();
    });
    
    historySearchOverlay.addEventListener('click', (e) => {
        if (e.target === historySearchOverlay) {
            cancelFileSearch();
        }
    });

    document.addEventListener('keydown', (e) => {
        if (modalOverlay.style.display === 'flex') {
            if (e.key === 'ArrowLeft') {
                e.preventDefault();
                const prevArrow = document.getElementById('prevArrow');
                if (prevArrow && !prevArrow.disabled) {
                    prevArrow.click();
                }
            } else if (e.key === 'ArrowRight') {
                e.preventDefault();
                const nextArrow = document.getElementById('nextArrow');
                if (nextArrow && !nextArrow.disabled) {
                    nextArrow.click();
                }
            } else if (e.key === 'Escape') {
                e.preventDefault();
                modalOverlay.style.display = 'none';
                cleanupObjectURLs();
            }
        }
        
        if (downloadSelectionModal.style.display === 'flex' && e.key === 'Escape') {
            e.preventDefault();
            downloadSelectionModal.style.display = 'none';
        }
        
        if (historySearchOverlay.style.display === 'flex' && e.key === 'Escape') {
            e.preventDefault();
            cancelFileSearch();
        }
        
        // Keyboard shortcuts
        if ((e.ctrlKey || e.metaKey) && e.key === 'o') {
            e.preventDefault();
            fileInput.click();
        }
        
        if ((e.ctrlKey || e.metaKey) && e.key === 'Enter' && !state.isProcessing) {
            e.preventDefault();
            if (state.selectedFiles.size > 0) {
                convertSelectedImages();
            }
        }
        
        if ((e.ctrlKey || e.metaKey) && e.key === 'a' && e.target === document.body) {
            e.preventDefault();
            selectAllFiles();
        }
        
        if (e.key === 'Escape' && state.selectedFiles.size > 0) {
            deselectAllFiles();
        }
    });
}

// Initialize Image Converter
function initImageConverter() {
    setupEventListeners();
    resetToInitialState();
    updateBlurState();
    historyManager.loadHistory();
    
    selectFormat('webp');
    selectCompression('none');
    updateQualityDisplay();
    
    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
        cleanupObjectURLs();
        if (state.progressInterval) {
            clearInterval(state.progressInterval);
        }
    });
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', initImageConverter);
</script>
</body>
</html>
